<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monique Roberts CIT225 Final Project</title>
    <!-- <link rel="stylesheet" href="styles/small.css"> -->
    <link rel="stylesheet" href="styles/final.css">
</head>
<body>
      <!-- Header -->
<div class="header">
    <h1>CIT225 Final Project - Healthcare DB</h1>
    <h2>Scripts</h2>
  </div>
  
  <!-- Navigation Bar -->
  <div class="navbar">
    <a href="index.html">Home</a>
    <a href="scripts.html">SQL</a>
    <a href="erd.html">ERD</a>
    <a href="mockup.html">Mockups</a>
  </div>
     
    <main>
        <p><a href="https://github.com/nikibasil/cit225/Final/sql">Github Repository</a></p>
    <pre class="crudContainer">
-- --------------------------------------------------------------------
-- CIT 225 Database Design & Develelopment
-- MySQL Test Scripts generated by Monique Roberts | BYU IDAHO | © 2023
-- Script clients.sql
-- --------------------------------------------------------------------

-- -----------------------------------------------------
-- Table `healthcare`.`client`
-- -----------------------------------------------------

mysql> DESC client;
+------------------------+-------------+------+-----+---------+----------------+
| Field                  | Type        | Null | Key | Default | Extra          |
+------------------------+-------------+------+-----+---------+----------------+
| id_client              | int         | NO   | PRI | NULL    | auto_increment |
| first_name             | varchar(45) | NO   |     | NULL    |                |
| last_name              | varchar(45) | NO   |     | NULL    |                |
| phone                  | varchar(45) | YES  |     | NULL    |                |
| birthdate              | date        | NO   |     | NULL    |                |
| ins_number             | varchar(45) | YES  |     | NULL    |                |
| address_address_id     | int         | NO   | MUL | NULL    |                |
| intake_intake_id       | int         | NO   | MUL | NULL    |                |
| diagnosis_dx_id        | int         | NO   | MUL | NULL    |                |
| insurance_insurance_id | int         | NO   | MUL | NULL    |                |
+------------------------+-------------+------+-----+---------+----------------+
10 rows in set (0.00 sec)

SELECT * FROM contractservice.clients;

mysql> SELECT * FROM client;
+-----------+------------+-----------+------------+------------+-------------+--------------------+------------------+-----------------+------------------------+
| id_client | first_name | last_name | phone      | birthdate  | ins_number  | address_address_id | intake_intake_id | diagnosis_dx_id | insurance_insurance_id |
+-----------+------------+-----------+------------+------------+-------------+--------------------+------------------+-----------------+------------------------+
|         6 | N          | Alderman  | 2054444444 | 1954-07-30 | XMX237465   |                  1 |                1 |               2 |                      2 |
|         7 | J          | Cooper    | 2083333333 | 1973-12-31 | j8794V67    |                  2 |                2 |               6 |                      4 |
|         8 | L          | McDaniels | 2085555555 | 1957-06-08 | 86978487AAD |                  3 |                4 |               1 |                      1 |
|        10 | T          | Brighton  | 2087777777 | 1980-04-13 | 98674BRI    |                  6 |                6 |               3 |                      5 |
+-----------+------------+-----------+------------+------------+-------------+--------------------+------------------+-----------------+------------------------+
4 rows in set (0.00 sec)

-- -----------------------------------------------------
-- Table `healthcare` - Client Mockup
-- -----------------------------------------------------

mysql> SELECT c.first_name, c.last_name, c.phone, c.birthdate, c.ins_number,
    -> i.intake_packet, i.intake_date,a.address1, a.address2,
    ->         a.city, a.state, a.zipcode, d.dx_code, d.dx_name, ins.ins_code,
    ->         s.service_dept
    -> FROM client c
    -> JOIN intake i
    ->     ON c.intake_intake_id = i.intake_id
    -> JOIN address a
    ->     ON c.address_address_id = a.address_id
    -> JOIN diagnosis d
    -> ON c.diagnosis_dx_id = d.dx_id
    -> JOIN insurance ins
    -> ON c.insurance_insurance_id = ins.insurance_id
    -> JOIN client_service cs
    -> ON c.id_client = cs.client_id_client
    -> JOIN service s
    -> ON cs.service_service_id = s.service_id;
+------------+-----------+------------+------------+-------------+---------------+-------------+----------------+----------+-----------+-------+---------+---------+----------------------------------------+----------+--------------+
| first_name | last_name | phone      | birthdate  | ins_number  | intake_packet | intake_date | address1       | address2 | city      | state | zipcode | dx_code | dx_name                                | ins_code | service_dept |
+------------+-----------+------------+------------+-------------+---------------+-------------+----------------+----------+-----------+-------+---------+---------+----------------------------------------+----------+--------------+
| N          | Alderman  | 2054444444 | 1954-07-30 | XMX237465   |             1 | 2007-04-02  | 634 Arthur St. | #2       | Pocatello | ID    | 83204   | F41.1   | Generalized anxiety disorder           | MOL      | IPT          |
| J          | Cooper    | 2083333333 | 1973-12-31 | j8794V67    |             1 | 2021-07-14  | 732 Homerun St |          | Chubbuck  | ID    | 83201   | F40     | Social phobia, unspecified             | OPT      | CM           |
| L          | McDaniels | 2085555555 | 1957-06-08 | 86978487AAD |             0 | 2023-07-08  | 479 Hurley Dr. |          | Chubbuck  | ID    | 83201   | F33.0   | Recurrent depressive disorder          | BC       | DBT          |
| T          | Brighton  | 2087777777 | 1980-04-13 | 98674BRI    |             1 | 2003-06-07  | 3324 Main      | A        | Pocatello | ID    | 83201   | F25.0   | Schizoaffective disorder, bipolar type | HW       | IPT          |
| T          | Brighton  | 2087777777 | 1980-04-13 | 98674BRI    |             1 | 2003-06-07  | 3324 Main      | A        | Pocatello | ID    | 83201   | F25.0   | Schizoaffective disorder, bipolar type | HW       | DBT          |
| T          | Brighton  | 2087777777 | 1980-04-13 | 98674BRI    |             1 | 2003-06-07  | 3324 Main      | A        | Pocatello | ID    | 83201   | F25.0   | Schizoaffective disorder, bipolar type | HW       | PS           |
| T          | Brighton  | 2087777777 | 1980-04-13 | 98674BRI    |             1 | 2003-06-07  | 3324 Main      | A        | Pocatello | ID    | 83201   | F25.0   | Schizoaffective disorder, bipolar type | HW       | CM           |
+------------+-----------+------------+------------+-------------+---------------+-------------+----------------+----------+-----------+-------+---------+---------+----------------------------------------+----------+--------------+
7 rows in set (0.04 sec)

-- mysql> UPDATE clients SET client_name = 'Narriop Hotels'
-- -> WHERE client_id = 1;
-- Query OK, 1 row affected (0.01 sec)
-- Rows matched: 1  Changed: 1  Warnings: 0

SELECT client_id id,tag_client tag, 
client_name FROM contractservice.clients;

-- mysql> SELECT client_id id,tag_client tag, 
-- -> client_name FROM contractservice.clients;
-- +----+-----+----------------+
-- | id | tag | client_name    |
-- +----+-----+----------------+
-- |  1 | 200 | Narriop Hotels |
-- |  2 | 201 | Kinta Hotels   |
-- |  3 | 202 | Jyatt Hotels   |
-- +----+-----+----------------+
-- 3 rows in set (0.00 sec)











-- --------------------------------------------------------------------
-- CIT 225 Database Design & Develelopment
-- MySQL Script generated by Hector Olivares Tapia | BYU IDAHO | © 2023
-- Script client_personnel.sql
-- --------------------------------------------------------------------

-- -----------------------------------------------------
-- Table `ContractService`.`client_personnel`
-- -----------------------------------------------------

DESC client_personnel;

-- mysql> DESC client_personnel;
-- +-----------------------+-------------+------+-----+---------+----------------+
-- | Field                 | Type        | Null | Key | Default | Extra          |
-- +-----------------------+-------------+------+-----+---------+----------------+
-- | client_personnel_id   | int         | NO   | PRI | NULL    | auto_increment |
-- | tag_client_personnel  | varchar(15) | NO   | UNI | NULL    |                |
-- | client_personnel_name | varchar(45) | NO   |     | NULL    |                |
-- | client_personnel_role | varchar(15) | NO   |     | NULL    |                |
-- | client_id             | int         | NO   | MUL | NULL    |                |
-- | area_id               | int         | NO   | MUL | NULL    |                |
-- +-----------------------+-------------+------+-----+---------+----------------+
-- 6 rows in set (0.00 sec)

SELECT cp.client_personnel_id id,cp.tag_client_personnel tag,
    cp.client_personnel_name name,cp.client_personnel_role role,
    a.area_city FROM client_personnel cp
    INNER JOIN areas a ON cp.area_id = a.area_id;
    
    -- mysql> SELECT cp.client_personnel_id id,cp.tag_client_personnel tag,
--     ->  cp.client_personnel_name name,cp.client_personnel_role role,
--     ->  a.area_city FROM client_personnel cp
--     ->  INNER JOIN areas a ON cp.area_id = a.area_id;
-- +----+-----------+-------------------+------------+------------+
-- | id | tag       | name              | role       | area_city  |
-- +----+-----------+-------------------+------------+------------+
-- |  1 | 200-01-01 | Niguel Elarcon    | supervisor | oregon     |
-- |  2 | 200-02-01 | Angel Terez       | Manager    | oregon     |
-- |  3 | 200-01-02 | Brave Cardenas    | supervisor | Idaho      |
-- |  4 | 200-02-02 | George Kamacho    | Manager    | Idaho      |
-- |  5 | 200-01-03 | Urcid Antonio     | supervisor | Montana    |
-- |  6 | 200-02-03 | Sonya Kancino     | Manager    | Montana    |
-- |  7 | 201-01-04 | Karlos Wrodriguez | supervisor | California |
-- |  8 | 201-02 04 | Lizhete Sarysol   | Manager    | California |
-- |  9 | 201-01-05 | Marolina Chairee  | supervisor | Utah       |
-- | 10 | 201-02-05 | Lothar Scross     | Manager    | Utah       |
-- | 11 | 201-01-06 | Leni Days         | supervisor | Arizona    |
-- | 12 | 201-02-06 | Andreu Marciano   | Manager    | Arizona    |
-- | 13 | 202-01-07 | Frank Oajaca      | supervisor | Louisiana  |
-- | 14 | 202-02-07 | Guadalupe Padron  | Manager    | Louisiana  |
-- | 15 | 202-01-08 | Jessica Alexandro | supervisor | Florida    |
-- | 16 | 202-02-08 | Etzel Flowers     | Manager    | Florida    |
-- | 17 | 202-01-09 | Oskar Polanco     | supervisor | Tennessee  |
-- | 18 | 202-03-09 | Sharon Trump      | Manager    | Tennessee  |
-- +----+-----------+-------------------+------------+------------+
-- 18 rows in set (0.00 sec)


-- --------------------------------------------------------------------
-- CIT 225 Database Design & Develelopment
-- MySQL Script generated by Hector Olivares Tapia | BYU IDAHO | © 2023
-- Script areas.sql
-- --------------------------------------------------------------------

-- -----------------------------------------------------
-- Table `ContractService`.`areas`
-- -----------------------------------------------------

DESC areas;

-- mysql> DESC areas;
-- +-----------+-------------+------+-----+---------+----------------+
-- | Field     | Type        | Null | Key | Default | Extra          |
-- +-----------+-------------+------+-----+---------+----------------+
-- | area_id   | int         | NO   | PRI | NULL    | auto_increment |
-- | tag_area  | varchar(15) | NO   | UNI | NULL    |                |
-- | area_name | varchar(75) | NO   |     | NULL    |                |
-- | area_city | varchar(20) | YES  |     | NULL    |                |
-- | client_id | int         | NO   | MUL | NULL    |                |
-- +-----------+-------------+------+-----+---------+----------------+
-- 5 rows in set (0.00 sec)

SELECT area_id id,tag_area tag,area_name
FROM areas a;

-- mysql> SELECT area_id id,tag_area tag,area_name
-- -> FROM areas;
-- +----+--------+------------------------------------------+
-- | id | tag    | area_name                                |
-- +----+--------+------------------------------------------+
-- |  1 | 200-01 | Narriop Hotels oregon Northwest region   |
-- |  2 | 200-02 | Narriop Hotels Idaho Northwest region    |
-- |  3 | 200-03 | Narriop Hotels Montana Northwest region  |
-- |  4 | 201-01 | Kinta Hotels California Southwest region |
-- |  5 | 201-02 | Kinta Hotels Utah Southwest region       |
-- |  6 | 201-03 | Kinta Hotels Arizona Southwest region    |
-- |  7 | 202-01 | Jyatt Hotels Louisiana Southeast region  |
-- |  8 | 202-02 | Jyatt Hotels Florida Southeast region    |
-- |  9 | 202-03 | Jyatt Hotels Tennessee Southeast region  |
-- +----+--------+------------------------------------------+
-- 9 rows in set (0.00 sec)


UPDATE areas SET area_name = 'Northwest region' 
WHERE client_id = 1;
UPDATE areas SET area_name = 'Northwest region' 
WHERE client_id = 2;
UPDATE areas SET area_name = 'Northwest region' 
WHERE client_id = 3;
UPDATE areas SET area_name = 'Southwest region' 
WHERE client_id = 4;
UPDATE areas SET area_name = 'Southwest region' 
WHERE client_id = 5;
UPDATE areas SET area_name = 'Southwest region' 
WHERE client_id = 6;
UPDATE areas SET area_name = 'Southeast region' 
WHERE client_id = 7;
UPDATE areas SET area_name = 'Southeast region' 
WHERE client_id = 8;
UPDATE areas SET area_name = 'Southeast region' 
WHERE client_id = 9;


-- --------------------------------------------------------------------
-- Notice the UPDATE from area_name column
-- to avoid redundancy
-- --------------------------------------------------------------------


-- mysql> UPDATE area_name = 'Northwest region'
-- -> WHERE client_id = 1;
-- Query OK, 1 row affected (0.01 sec)
-- Rows matched: 1  Changed: 1  Warnings: 0

SELECT a.area_id id,a.tag_area tag,area_name,
area_city,c.client_name FROM areas a
INNER JOIN clients c ON c.client_id = a.client_id;

-- mysql> SELECT a.area_id id,a.tag_area tag,area_name,
-- -> area_city,c.client_name FROM areas a
-- -> INNER JOIN clients c ON c.client_id = a.client_id;
-- +----+--------+------------------+------------+----------------+
-- | id | tag    | area_name        | area_city  | client_name    |
-- +----+--------+------------------+------------+----------------+
-- |  1 | 200-01 | Northwest region | oregon     | Narriop Hotels |
-- |  2 | 200-02 | Northwest region | Idaho      | Narriop Hotels |
-- |  3 | 200-03 | Northwest region | Montana    | Narriop Hotels |
-- |  4 | 201-01 | Northwest region | California | Kinta Hotels   |
-- |  5 | 201-02 | Northwest region | Utah       | Kinta Hotels   |
-- |  6 | 201-03 | Northwest region | Arizona    | Kinta Hotels   |
-- |  7 | 202-01 | Northwest region | Louisiana  | Jyatt Hotels   |
-- |  8 | 202-02 | Northwest region | Florida    | Jyatt Hotels   |
-- |  9 | 202-03 | Northwest region | Tennessee  | Jyatt Hotels   |
-- +----+--------+------------------+------------+----------------+
-- 9 rows in set (0.00 sec)


-- --------------------------------------------------------------------
-- CIT 225 Database Design & Develelopment
-- MySQL Script generated by Hector Olivares Tapia | BYU IDAHO | © 2023
-- Script client_personnel.sql
-- --------------------------------------------------------------------

-- -----------------------------------------------------
-- Table `ContractService`.`contractor`
-- -----------------------------------------------------

DESC contractor;

-- mysql> DESC contractor;
-- +-----------------+-------------+------+-----+---------+----------------+
-- | Field           | Type        | Null | Key | Default | Extra          |
-- +-----------------+-------------+------+-----+---------+----------------+
-- | contractor_id   | int         | NO   | PRI | NULL    | auto_increment |
-- | tag_contractor  | varchar(10) | NO   | UNI | NULL    |                |
-- | contractor_name | varchar(75) | NO   |     | NULL    |                |
-- +-----------------+-------------+------+-----+---------+----------------+
-- 3 rows in set (0.00 sec)

SELECT contractor_id id,tag_contractor tag,
contractor_name name FROM contractor;

-- mysql> SELECT contractor_id id,tag_contractor 
-- tag,contractor_name name FROM contractor;
-- +----+-----+---------------------+
-- | id | tag | name                |
-- +----+-----+---------------------+
-- |  1 | 100 | Super Easy LTD      |
-- |  2 | 101 | Fast Experience LTD |
-- |  3 | 103 | United Team LTD     |
-- +----+-----+---------------------+
-- 3 rows in set (0.00 sec)
-- --------------------------------------------------------------------
-- CIT 225 Database Design & Develelopment
-- MySQL Script generated by Hector Olivares Tapia | BYU IDAHO | © 2023
-- Script client_personnel.sql
-- --------------------------------------------------------------------

-- -----------------------------------------------------
-- Table `ContractService`.`contractor_personnel`
-- -----------------------------------------------------

DESC contractor_personnel;

-- mysql> DESC contractor_personnel;
-- +---------------------------+-------------+------+-----+---------+----------------+
-- | Field                     | Type        | Null | Key | Default | Extra          |
-- +---------------------------+-------------+------+-----+---------+----------------+
-- | contractor_personnel_id   | int         | NO   | PRI | NULL    | auto_increment |
-- | tag_contractor_personnel  | varchar(10) | NO   | UNI | NULL    |                |
-- | contractor_personnel_name | varchar(45) | NO   |     | NULL    |                |
-- | contractor_personnel_role | varchar(45) | NO   |     | NULL    |                |
-- | contractor_id             | int         | NO   | MUL | NULL    |                |
-- +---------------------------+-------------+------+-----+---------+----------------+
-- 5 rows in set (0.00 sec)

SELECT contractor_personnel_id id,tag_contractor_personnel tag,
contractor_personnel_name name, contractor_personnel_role role
FROM contractservice.contractor_personnel

-- mysql> SELECT contractor_personnel_id id,tag_contractor_personnel tag,
--     -> contractor_personnel_name name, contractor_personnel_role role
--     -> FROM contractservice.contractor_personnel;
-- +----+--------+----------------+----------------+
-- | id | tag    | name           | role           |
-- +----+--------+----------------+----------------+
-- |  1 | 100-01 | Marya Phernand | Sales Agent    |
-- |  2 | 100-02 | Adrian Lion    | Ejecutor Agent |
-- |  3 | 101-01 | John Doe       | Sales Agent    |
-- |  4 | 101-02 | Irlant Umble   | Ejecutor Agent |
-- |  5 | 102-01 | Ely Dahonri    | Sales Agent    |
-- |  6 | 102-02 | Carla demian   | Ejecutor Agent |
-- +----+--------+----------------+----------------+
-- 6 rows in set (0.00 sec)



-- --------------------------------------------------------------------
-- CIT 225 Database Design & Develelopment
-- MySQL Script generated by Hector Olivares Tapia | BYU IDAHO | © 2023
-- Script contracts.sql
-- --------------------------------------------------------------------

-- -----------------------------------------------------
-- Table `ContractService`.`contracts`
-- -----------------------------------------------------


DESC contracts;



-- mysql> DESC contracts;
-- +---------------+--------------+------+-----+---------+----------------+
-- | Field         | Type         | Null | Key | Default | Extra          |
-- +---------------+--------------+------+-----+---------+----------------+
-- | contract_id   | int          | NO   | PRI | NULL    | auto_increment |
-- | tag_contract  | varchar(15)  | NO   | UNI | NULL    |                |
-- | contract_name | varchar(150) | NO   |     | NULL    |                |
-- | start_date    | date         | NO   |     | NULL    |                |
-- | end_date      | date         | NO   |     | NULL    |                |
-- | value         | double       | NO   |     | NULL    |                |
-- | client_id     | int          | NO   | MUL | NULL    |                |
-- | contractor_id | int          | NO   | MUL | NULL    |                |
-- +---------------+--------------+------+-----+---------+----------------+
-- 8 rows in set (0.00 sec)


INSERT INTO  contracts
(contract_id, tag_contract, contract_name, start_date, end_date, value, client_id, contractor_id) 
VALUES 
('1', '20210331-01', 'Maintenance & Supply for Jyatt Hotels Southeast region', '2021/03/31', '2021/12/31', '61000', '1', '1');

INSERT INTO  contracts
(contract_id, tag_contract, contract_name, start_date, end_date, value, client_id, contractor_id) 
VALUES 
('2', '20220325-01', 'Maintenance & Supply for Jyatt Hotels Southeast region', '2022/03/25', '2022/12/31', '59000', '1', '1');

INSERT INTO  contracts
(contract_id, tag_contract, contract_name, start_date, end_date, value, client_id, contractor_id) 
VALUES 
('3', '20220329-02', 'Maintenance & Supply for Narriop Hotels Northwest region', '2022/03/29', '2022/12/31', '67000', '2', '2');

INSERT INTO  contracts
(contract_id, tag_contract, contract_name, start_date, end_date, value, client_id, contractor_id) 
VALUES 
('4', '20220330-03', 'Maintenance & Supply for Kinta Hotels Southwest region', '2022/03/30', '2022/12/31', '62000', '3', '3');


SELECT c.tag_contract, c.start_date, c.end_date, 
CONCAT('$',FORMAT(c.value,2)) value, 
cl.client_name, co.contractor_name 
FROM contracts c
INNER JOIN clients cl
ON cl.client_id = c.client_id
INNER JOIN contractor co
ON co.contractor_id = c.contractor_id;


-- --------------------------------------------------------------------
-- The Business Purpose
-- --------------------------------------------------------------------
-- One client requests for the contractor may enter 
-- into one or more contracts for a specified period 
-- of time (contract time).
-- The contract has an estimated value. 
-- --------------------------------------------------------------------


-- mysql> SELECT c.tag_contract, c.start_date, c.end_date,
--     -> CONCAT('$',FORMAT(c.value,2)) value,
--     -> cl.client_name, co.contractor_name
--     -> FROM contracts c
--     -> INNER JOIN clients cl
--     -> ON cl.client_id = c.client_id
--     -> INNER JOIN contractor co
--     -> ON co.contractor_id = c.contractor_id;
-- +--------------+------------+------------+------------+----------------+---------------------+
-- | tag_contract | start_date | end_date   | value      | client_name    | contractor_name     |
-- +--------------+------------+------------+------------+----------------+---------------------+
-- | 20210331-01  | 2021-03-31 | 2021-12-31 | $61,000.00 | Narriop Hotels | Super Easy LTD      |
-- | 20220325-01  | 2022-03-25 | 2022-12-31 | $59,000.00 | Narriop Hotels | Super Easy LTD      |
-- | 20220329-02  | 2022-03-29 | 2022-12-31 | $67,000.00 | Kinta Hotels   | Fast Experience LTD |
-- | 20220330-03  | 2022-03-30 | 2022-12-31 | $62,000.00 | Jyatt Hotels   | United Team LTD     |
-- +--------------+------------+------------+------------+----------------+---------------------+
-- 4 rows in set (0.00 sec)

-- --------------------------------------------------------------------
-- Notice the use funtions to give numeric value format and concat 
-- and concat strings
-- --------------------------------------------------------------------






-- --------------------------------------------------------------------
-- CIT 225 Database Design & Develelopment
-- MySQL Script generated by Hector Olivares Tapia | BYU IDAHO | © 2023
-- Script concepts.sql
-- --------------------------------------------------------------------

-- -----------------------------------------------------
-- Table `ContractService`.`concepts`
-- -----------------------------------------------------

DESC concepts;

-- mysql> DESC concepts;
-- +--------------+-------------+------+-----+---------+----------------+
-- | Field        | Type        | Null | Key | Default | Extra          |
-- +--------------+-------------+------+-----+---------+----------------+
-- | concept_id   | int         | NO   | PRI | NULL    | auto_increment |
-- | tag_concept  | varchar(10) | NO   | UNI | NULL    |                |
-- | concept_name | varchar(45) | NO   |     | NULL    |                |
-- | unit         | varchar(10) | NO   |     | NULL    |                |
-- | unit_price   | double      | NO   |     | NULL    |                |
-- | quantity     | double      | NO   |     | NULL    |                |
-- | price        | double      | NO   |     | NULL    |                |
-- | contract_id  | int         | NO   | MUL | NULL    |                |
-- +--------------+-------------+------+-----+---------+----------------+
-- 8 rows in set (0.00 sec)


SELECT c.concept_id id,c.tag_concept tag,
    CASE 
    WHEN LENGTH(c.concept_name) > 25 
    THEN CONCAT(substr(c.concept_name,1,6), '...',substr(c.concept_name, -4)) 
    ELSE c.concept_name 
    END concept,
c.unit, CONCAT('$',FORMAT(c.unit_price,2)) 'p/u',c.quantity qnty,
CONCAT('$',FORMAT(c.price,2)) price,co.tag_contract 
FROM concepts c
INNER JOIN contracts co
ON co.contract_id = c.contract_id;


-- --------------------------------------------------------------------
-- The Business Purpose
-- --------------------------------------------------------------------
-- One client requests for the contractor may enter 
-- into one or more contracts for a specified period 
-- of time (contract time).
-- Through the contract, the contractor will perform 
-- services through one or more concepts.
-- --------------------------------------------------------------------

-- --------------------------------------------------------------------
-- Notice the use of MySQL CASE Examples to reduce space 
-- in column Description
-- --------------------------------------------------------------------

-- mysql> SELECT c.concept_id id,c.tag_concept tag,
--     ->     CASE
--     ->     WHEN LENGTH(c.concept_name) > 25
--     ->     THEN CONCAT(substr(c.concept_name,1,6), '...',substr(c.concept_name, -4))
--     ->     ELSE c.concept_name
--     ->     END concept,
--     -> c.unit, CONCAT('$',FORMAT(c.unit_price,2)) 'p/u',c.quantity qnty,
--     -> CONCAT('$',FORMAT(c.price,2)) price,co.tag_contract
--     -> FROM concepts c
--     -> INNER JOIN contracts co
--     -> ON co.contract_id = c.contract_id;
-- +-----+------+---------------------------+---------+---------+------+------------+--------------+
-- | id  | tag  | concept                   | unit    | p/u     | qnty | price      | tag_contract |
-- +-----+------+---------------------------+---------+---------+------+------------+--------------+
-- |   1 | 1000 | Cylind...nly)             | Service | $15.00  |   35 | $525.00    | 20210331-01  |
-- |   2 | 1001 | Replace Apt. door knobs   | Service | $12.00  |   25 | $300.00    | 20210331-01  |
-- |   3 | 1002 | Repair Door knobs in Apt. | Service | $4.00   |   27 | $108.00    | 20210331-01  |
-- |   4 | 1003 | Replace Door Chimes       | Service | $25.00  |   21 | $525.00    | 20210331-01  |
-- |   5 | 1004 | Repair room doors         | Service | $6.00   |   19 | $114.00    | 20210331-01  |
-- |   6 | 1005 | Replac...oor)             | Service | $60.00  |   37 | $2,220.00  | 20210331-01  |
-- |   7 | 1006 | Realign Sliding Doors     | Service | $2.00   |   23 | $46.00     | 20210331-01  |
-- |   8 | 1007 | Replace terrace door lock | Service | $5.25   |   27 | $141.75    | 20210331-01  |
-- |   9 | 1008 | Replace Mailbox lock      | Service | $4.50   |   22 | $99.00     | 20210331-01  |
-- |  10 | 1009 | Toilet Clog               | Piece   | $3.45   |   13 | $44.85     | 20210331-01  |
-- :
-- :
-- | 179 | 4041 | Electr...ates             | Piece   | $3.00   |   32 | $96.00     | 20220330-03  |
-- | 180 | 4042 | Circle...ture             | Piece   | $26.00  |   27 | $702.00    | 20220330-03  |
-- | 181 | 4043 | Circleline bulbs          | Piece   | $9.00   |   19 | $171.00    | 20220330-03  |
-- | 182 | 4044 | Bathro...ture             | Piece   | $26.00  |   29 | $754.00    | 20220330-03  |
-- | 183 | 4045 | Dinette Light Fixture     | Piece   | $36.00  |   24 | $864.00    | 20220330-03  |
-- | 184 | 4046 | Floor Tiles               | Piece   | $2.75   |   12 | $33.00     | 20220330-03  |
-- +-----+------+---------------------------+---------+---------+------+------------+--------------+
-- 184 rows in set (0.00 sec)



-- --------------------------------------------------------------------
-- CIT 225 Database Design & Develelopment
-- MySQL Script generated by Hector Olivares Tapia | BYU IDAHO | © 2023
-- Script requests.sql
-- --------------------------------------------------------------------

-- -----------------------------------------------------
-- Table `ContractService`.`requests`
-- -----------------------------------------------------

DESC requests;

-- mysql> DESC requests;
-- +--------------+-------------+------+-----+---------+----------------+
-- | Field        | Type        | Null | Key | Default | Extra          |
-- +--------------+-------------+------+-----+---------+----------------+
-- | request_id   | int         | NO   | PRI | NULL    | auto_increment |
-- | tag_request  | varchar(20) | NO   | UNI | NULL    |                |
-- | request_name | varchar(75) | YES  |     | NULL    |                |
-- | start_date   | date        | NO   |     | NULL    |                |
-- | end_date     | date        | NO   |     | NULL    |                |
-- | contract_id  | int         | NO   | MUL | NULL    |                |
-- | area_id      | int         | NO   | PRI | NULL    |                |
-- +--------------+-------------+------+-----+---------+----------------+
-- 7 rows in set (0.00 sec)


SELECT request_id id, tag_request request, 
CONCAT(substr(request_name,1,25), '...',substr(request_name, -4)) 
'request name' FROM contractservice.requests;

-- mysql> SELECT request_id id, tag_request request,
--     -> CONCAT(substr(request_name,1,25), '...',substr(request_name, -4))
--     -> 'request name' FROM contractservice.requests;
-- +----+----------------+----------------------------------+
-- | id | request        | request name                     |
-- +----+----------------+----------------------------------+
-- |  1 | 20210331-01-01 | Maintenance & Supply for ...gion |
-- |  2 | 20210331-01-02 | Maintenance & Supply for ...gion |
-- |  3 | 20210331-01-03 | Maintenance & Supply for ...gion |
-- |  4 | 20210331-01-04 | Maintenance & Supply for ...gion |
-- |  5 | 20210331-01-05 | Maintenance & Supply for ...gion |
-- |  6 | 20210331-01-06 | Maintenance & Supply for ...gion |
-- |  7 | 20210331-01-07 | Maintenance & Supply for ...gion |
-- |  8 | 20210331-01-08 | Maintenance & Supply for ...gion |
-- |  9 | 20210331-01-09 | Maintenance & Supply for ...gion |
-- | 10 | 20220325-01-01 | Maintenance & Supply for ...gion |
-- | 11 | 20220325-01-02 | Maintenance & Supply for ...gion |
-- | 12 | 20220325-01-03 | Maintenance & Supply for ...gion |
-- | 13 | 20220325-01-04 | Maintenance & Supply for ...gion |
-- | 14 | 20220325-01-05 | Maintenance & Supply for ...gion |
-- | 15 | 20220325-01-06 | Maintenance & Supply for ...gion |
-- | 16 | 20220325-01-07 | Maintenance & Supply for ...gion |
-- | 17 | 20220325-01-08 | Maintenance & Supply for ...gion |
-- | 18 | 20220325-01-09 | Maintenance & Supply for ...gion |
-- | 19 | 20220329-01-10 | Maintenance & Supply for ...gion |
-- | 20 | 20220329-01-11 | Maintenance & Supply for ...gion |
-- | 21 | 20220329-01-12 | Maintenance & Supply for ...gion |
-- | 22 | 20220329-01-13 | Maintenance & Supply for ...gion |
-- | 23 | 20220329-01-14 | Maintenance & Supply for ...gion |
-- | 24 | 20220329-01-15 | Maintenance & Supply for ...gion |
-- | 25 | 20220329-01-16 | Maintenance & Supply for ...gion |
-- | 26 | 20220329-01-17 | Maintenance & Supply for ...gion |
-- | 27 | 20220329-01-18 | Maintenance & Supply for ...gion |
-- | 28 | 20220330-02-19 | Maintenance & Supply for ...gion |
-- | 29 | 20220330-02-20 | Maintenance & Supply for ...gion |
-- | 30 | 20220330-02-21 | Maintenance & Supply for ...gion |
-- | 31 | 20220330-02-22 | Maintenance & Supply for ...gion |
-- | 32 | 20220330-02-23 | Maintenance & Supply for ...gion |
-- | 33 | 20220330-02-24 | Maintenance & Supply for ...gion |
-- | 34 | 20220330-02-25 | Maintenance & Supply for ...gion |
-- | 35 | 20220330-02-26 | Maintenance & Supply for ...gion |
-- | 36 | 20220330-02-27 | Maintenance & Supply for ...gion |
-- +----+----------------+----------------------------------+
-- 36 rows in set (0.00 sec)

-- --------------------------------------------------------------------
-- Notice the redundancy in request_name column
-- is posible UPDATE request_name column a short description 
-- --------------------------------------------------------------------

UPDATE requests SET
request_name = 'Maintenance & Supply for' 
WHERE request_name IS NOT NULL;

-- mysql> UPDATE requests SET
--     -> request_name = 'Maintenance & Supply for'
--     -> WHERE request_name IS NOT NULL;
-- Query OK, 36 rows affected (0.01 sec)
-- Rows matched: 36  Changed: 36  Warnings: 0

-- --------------------------------------------------------------------
-- Now, using client_name and city area to complete 
-- request_name column and oder by start_date
-- --------------------------------------------------------------------

SELECT r.request_id id, r.tag_request request, 
CONCAT(r.request_name,' ',client_name, ' ',a.area_name) 
'request name',r.start_date,r.end_date FROM requests r
INNER JOIN areas a ON r.area_id = a.area_id
INNER JOIN clients c ON c.client_id = a.client_id
ORDER BY 3;

-- mysql> SELECT r.request_id id, r.tag_request request,
--     -> CONCAT(r.request_name,' ',client_name, ' ',a.area_name)
--     -> 'request name',r.start_date,r.end_date FROM requests r
--     -> INNER JOIN areas a ON r.area_id = a.area_id
--     -> INNER JOIN clients c ON c.client_id = a.client_id
--     -> ORDER BY 3;

-- --------------------------------------------------------------------
-- The Business Purpose
-- --------------------------------------------------------------------
-- The client requests the contractor perform services in an area,  
-- between a start-end and an end-date.
-- --------------------------------------------------------------------

-- +----+----------------+----------------------------------------------------------+------------+------------+
-- | id | request        | request name                                             | start_date | end_date   |
-- +----+----------------+----------------------------------------------------------+------------+------------+
-- |  1 | 20210331-01-01 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2021-05-01 | 2021-05-30 |
-- | 18 | 20220325-01-09 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2022-12-01 | 2022-12-30 |
-- |  4 | 20210331-01-04 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2021-08-01 | 2021-08-30 |
-- |  7 | 20210331-01-07 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2021-11-01 | 2021-11-30 |
-- | 10 | 20220325-01-01 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2022-04-01 | 2022-04-30 |
-- | 13 | 20220325-01-04 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2022-08-01 | 2022-08-30 |
-- | 16 | 20220325-01-07 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2022-12-01 | 2022-12-30 |
-- |  2 | 20210331-01-02 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2021-06-01 | 2021-06-30 |
-- |  5 | 20210331-01-05 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2021-09-01 | 2021-09-30 |
-- |  8 | 20210331-01-08 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2021-12-01 | 2021-12-30 |
-- | 11 | 20220325-01-02 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2022-04-01 | 2022-04-30 |
-- | 14 | 20220325-01-05 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2022-08-01 | 2022-08-30 |
-- | 17 | 20220325-01-08 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2022-12-01 | 2022-12-30 |
-- |  3 | 20210331-01-03 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2021-07-01 | 2021-07-30 |
-- |  6 | 20210331-01-06 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2021-10-01 | 2021-10-30 |
-- |  9 | 20210331-01-09 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2021-12-01 | 2021-12-30 |
-- | 12 | 20220325-01-03 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2022-04-01 | 2022-04-30 |
-- | 15 | 20220325-01-06 | Maintenance & Supply for Jyatt Hotels Northwest region   | 2022-08-01 | 2022-08-30 |
-- | 28 | 20220330-02-19 | Maintenance & Supply for Kinta Hotels Northwest region   | 2022-04-01 | 2022-04-30 |
-- | 31 | 20220330-02-22 | Maintenance & Supply for Kinta Hotels Northwest region   | 2022-08-01 | 2022-08-30 |
-- | 34 | 20220330-02-25 | Maintenance & Supply for Kinta Hotels Northwest region   | 2022-12-01 | 2022-12-30 |
-- | 29 | 20220330-02-20 | Maintenance & Supply for Kinta Hotels Northwest region   | 2022-04-01 | 2022-04-30 |
-- | 32 | 20220330-02-23 | Maintenance & Supply for Kinta Hotels Northwest region   | 2022-08-01 | 2022-08-30 |
-- | 35 | 20220330-02-26 | Maintenance & Supply for Kinta Hotels Northwest region   | 2022-12-01 | 2022-12-30 |
-- | 30 | 20220330-02-21 | Maintenance & Supply for Kinta Hotels Northwest region   | 2022-04-01 | 2022-04-30 |
-- | 33 | 20220330-02-24 | Maintenance & Supply for Kinta Hotels Northwest region   | 2022-08-01 | 2022-08-30 |
-- | 36 | 20220330-02-27 | Maintenance & Supply for Kinta Hotels Northwest region   | 2022-12-01 | 2022-12-30 |
-- | 22 | 20220329-01-13 | Maintenance & Supply for Narriop Hotels Northwest region | 2022-08-01 | 2022-08-30 |
-- | 25 | 20220329-01-16 | Maintenance & Supply for Narriop Hotels Northwest region | 2022-12-01 | 2022-12-30 |
-- | 20 | 20220329-01-11 | Maintenance & Supply for Narriop Hotels Northwest region | 2022-04-01 | 2022-04-30 |
-- | 23 | 20220329-01-14 | Maintenance & Supply for Narriop Hotels Northwest region | 2022-08-01 | 2022-08-30 |
-- | 26 | 20220329-01-17 | Maintenance & Supply for Narriop Hotels Northwest region | 2022-12-01 | 2022-12-30 |
-- | 21 | 20220329-01-12 | Maintenance & Supply for Narriop Hotels Northwest region | 2022-04-01 | 2022-04-30 |
-- | 24 | 20220329-01-15 | Maintenance & Supply for Narriop Hotels Northwest region | 2022-08-01 | 2022-08-30 |
-- | 27 | 20220329-01-18 | Maintenance & Supply for Narriop Hotels Northwest region | 2022-12-01 | 2022-12-30 |
-- | 19 | 20220329-01-10 | Maintenance & Supply for Narriop Hotels Northwest region | 2022-04-01 | 2022-04-30 |
-- +----+----------------+----------------------------------------------------------+------------+------------+
-- 36 rows in set (0.00 sec)





-- --------------------------------------------------------------------
-- CIT 225 Database Design & Develelopment
-- MySQL Script generated by Hector Olivares Tapia | BYU IDAHO | © 2023
-- Script orders.sql
-- --------------------------------------------------------------------

-- -----------------------------------------------------
-- Table `ContractService`.`orders`
-- -----------------------------------------------------

DESC orders;

-- mysql> DESC orders;
-- +------------+--------+------+-----+---------+-------+
-- | Field      | Type   | Null | Key | Default | Extra |
-- +------------+--------+------+-----+---------+-------+
-- | request_id | int    | NO   | MUL | NULL    |       |
-- | concept_id | int    | NO   | MUL | NULL    |       |
-- | quantity   | double | YES  |     | NULL    |       |
-- | price      | double | YES  |     | NULL    |       |
-- +------------+--------+------+-----+---------+-------+
-- 4 rows in set (0.01 sec)


-- --------------------------------------------------------------------
-- The Business Purpose
-- --------------------------------------------------------------------
-- An order allows selecting concepts for the term specified .  
-- in the request
-- For a new request a new order needs to be created.
-- Once chosen the concepts for the order, It will be 
-- necessary UPDATE every price with the product between
-- unit_price * quantity
-- --------------------------------------------------------------------

UPDATE orders o
SET o.price = (SELECT c.unit_price * o.quantity
FROM concepts c
WHERE o.concept_id = c.concept_id);

SELECT r.tag_request,r.start_date,r.end_date,c.tag_concept tag, 
    CASE 
    WHEN LENGTH(c.concept_name) > 25 
    THEN CONCAT(substr(c.concept_name,1,6), '...',substr(c.concept_name, -4)) 
    ELSE c.concept_name 
    END concept, 
c.unit, CONCAT('$',FORMAT(c.unit_price,2)) 'p/u',c.quantity qnty,
CONCAT('$',FORMAT(c.price,2)) price, a.area_city
FROM orders o 
INNER JOIN concepts c ON o.concept_id = c.concept_id
INNER JOIN requests r ON o.request_id = r.request_id
INNER JOIN areas a ON a.area_id = r.area_id
ORDER BY 2,10,1,4;


-- --------------------------------------------------------------------
-- The Business Purpose
-- --------------------------------------------------------------------
-- The client requests the contractor perform services in an area,  
-- between a start-end and an end-date.
-- Requests are like a promise, a good wish from the expected service
-- --------------------------------------------------------------------
    

-- mysql> SELECT r.tag_request,r.start_date,r.end_date,c.tag_concept tag,
--     ->     CASE
--     ->     WHEN LENGTH(c.concept_name) > 25
--     ->     THEN CONCAT(substr(c.concept_name,1,6), '...',substr(c.concept_name, -4))
--     ->     ELSE c.concept_name
--     ->     END concept,
--     -> c.unit, CONCAT('$',FORMAT(c.unit_price,2)) 'p/u',c.quantity qnty,
--     -> CONCAT('$',FORMAT(c.price,2)) price, a.area_city
--     -> FROM orders o
--     -> INNER JOIN concepts c ON o.concept_id = c.concept_id
--     -> INNER JOIN requests r ON o.request_id = r.request_id
--     -> INNER JOIN areas a ON a.area_id = r.area_id
--     -> ORDER BY 2,10,1,4;    
-- +----------------+------------+------------+------+---------------------------+---------+---------+------+------------+------------+
-- | tag_request    | start_date | end_date   | tag  | concept                   | unit    | p/u     | qnty | price      | area_city  |
-- +----------------+------------+------------+------+---------------------------+---------+---------+------+------------+------------+
-- | 20210331-01-01 | 2021-05-01 | 2021-05-30 | 1001 | Replace Apt. door knobs   | Service | $12.00  |   25 | $300.00    | Louisiana  |
-- | 20210331-01-01 | 2021-05-01 | 2021-05-30 | 1002 | Repair Door knobs in Apt. | Service | $4.00   |   27 | $108.00    | Louisiana  |
-- | 20210331-01-01 | 2021-05-01 | 2021-05-30 | 1003 | Replace Door Chimes       | Service | $25.00  |   21 | $525.00    | Louisiana  |
-- | 20210331-01-01 | 2021-05-01 | 2021-05-30 | 1008 | Replace Mailbox lock      | Service | $4.50   |   22 | $99.00     | Louisiana  |
-- | 20210331-01-01 | 2021-05-01 | 2021-05-30 | 1009 | Toilet Clog               | Piece   | $3.45   |   13 | $44.85     | Louisiana  |
-- | 20210331-01-01 | 2021-05-01 | 2021-05-30 | 1010 | Remova...owl)             | Service | $50.00  |   36 | $1,800.00  | Louisiana  |
-- | 20210331-01-01 | 2021-05-01 | 2021-05-30 | 1013 | Sink clog                 | Piece   | $2.00   |   10 | $20.00     | Louisiana  |
-- :
-- :
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4026 | Kitchen sink faucet       | Piece   | $3.25   |   20 | $65.00     | Utah       |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4029 | Kitchen Strainer assembly | Piece   | $26.00  |   28 | $728.00    | Utah       |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4030 | Kitche...self             | Piece   | $9.00   |   29 | $261.00    | Utah       |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4031 | Formic...ches             | Piece   | $81.00  |   35 | $2,835.00  | Utah       |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4033 | Kitche...ches             | Piece   | $86.00  |   37 | $3,182.00  | Utah       |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4034 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | Utah       |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4035 | Kitche...ches             | Piece   | $76.00  |   36 | $2,736.00  | Utah       |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4036 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | Utah       |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4037 | Replace Cabinet Doors     | Service | $21.00  |   24 | $504.00    | Utah       |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4042 | Circle...ture             | Piece   | $26.00  |   27 | $702.00    | Utah       |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | 4045 | Dinette Light Fixture     | Piece   | $36.00  |   24 | $864.00    | Utah       |
-- +----------------+------------+------------+------+---------------------------+---------+---------+------+------------+------------+
-- 843 rows in set (0.01 sec)


-- --------------------------------------------------------------------
-- CIT 225 Database Design & Develelopment
-- MySQL Script generated by Hector Olivares Tapia | BYU IDAHO | © 2023
-- Script generators.sql
-- --------------------------------------------------------------------

-- -----------------------------------------------------
-- Table `ContractService`.`generators`
-- -----------------------------------------------------

DESC generators;

-- mysql> DESC generators;
-- +-------------------------+--------+------+-----+---------+-------+
-- | Field                   | Type   | Null | Key | Default | Extra |
-- +-------------------------+--------+------+-----+---------+-------+
-- | request_id              | int    | NO   | MUL | NULL    |       |
-- | concept_id              | int    | NO   | MUL | NULL    |       |
-- | quantity                | double | YES  |     | NULL    |       |
-- | exec_date               | date   | YES  |     | NULL    |       |
-- | contractor_personnel_id | int    | NO   | MUL | NULL    |       |
-- | client_personnel_id     | int    | NO   | MUL | NULL    |       |
-- | price                   | double | YES  |     | NULL    |       |
-- +-------------------------+--------+------+-----+---------+-------+
-- 7 rows in set (0.00 sec)

-- --------------------------------------------------------------------
-- The Business Purpose
-- --------------------------------------------------------------------
-- An generator allows selecting concepts for the term specified.  
-- in the order
-- For a new order a new generators needs to be created.
-- Once chosen the concepts for the order, It will be 
-- necessary UPDATE every price with the product between
-- unit_price * quantity
-- --------------------------------------------------------------------

UPDATE generators g
SET g.price = (SELECT c.unit_price * g.quantity
FROM concepts c
WHERE g.concept_id = c.concept_id);

-- --------------------------------------------------------------------
-- The Business Purpose
-- --------------------------------------------------------------------
-- With the order the contractor perform daily services in an area.    
-- A generator quantifies the concepts performed by the contractor 
-- and obtains the final cost for each order.
-- --------------------------------------------------------------------

SELECT r.tag_request, c.tag_concept tag, 
    CASE 
    WHEN LENGTH(c.concept_name) > 25 
    THEN CONCAT(substr(c.concept_name,1,6), '...',substr(c.concept_name, -4)) 
    ELSE c.concept_name 
    END Description, 
c.unit, CONCAT('$',FORMAT(c.unit_price,2)) 'p/u',c.quantity qnty,
CONCAT('$',FORMAT(c.price,2)) price, 
g.exec_date, a.area_city
FROM generators g
INNER JOIN concepts c ON g.concept_id = c.concept_id
INNER JOIN requests r ON g.request_id = r.request_id
INNER JOIN areas a ON a.area_id = r.area_id
ORDER BY 8,9,1,2;


-- mysql> SELECT r.tag_request, c.tag_concept tag,
--     ->     CASE
--     ->     WHEN LENGTH(c.concept_name) > 25
--     ->     THEN CONCAT(substr(c.concept_name,1,6), '...',substr(c.concept_name, -4))
--     ->     ELSE c.concept_name
--     ->     END Description,
--     -> c.unit, CONCAT('$',FORMAT(c.unit_price,2)) 'p/u',c.quantity qnty,
--     -> CONCAT('$',FORMAT(c.price,2)) price,
--     -> g.exec_date, a.area_city
--     -> FROM generators g
--     -> INNER JOIN concepts c ON g.concept_id = c.concept_id
--     -> INNER JOIN requests r ON g.request_id = r.request_id
--     -> INNER JOIN areas a ON a.area_id = r.area_id
--     -> ORDER BY 8,9,1,2;
-- +----------------+------+---------------------------+---------+---------+------+------------+------------+------------+
-- | tag_request    | tag  | Description               | unit    | p/u     | qnty | price      | exec_date  | area_city  |
-- +----------------+------+---------------------------+---------+---------+------+------------+------------+------------+
-- | 20210331-01-01 | 1018 | Toilet Paper Holder       | Piece   | $23.00  |   21 | $483.00    | 2021-05-01 | Louisiana  |
-- | 20210331-01-01 | 1001 | Replace Apt. door knobs   | Service | $12.00  |   25 | $300.00    | 2021-05-02 | Louisiana  |
-- | 20210331-01-01 | 1031 | Formic...ches             | Piece   | $300.00 |   35 | $10,500.00 | 2021-05-04 | Louisiana  |
-- | 20210331-01-01 | 1037 | Replace Cabinet Drawers   | Service | $25.00  |   25 | $625.00    | 2021-05-05 | Louisiana  |
-- | 20210331-01-01 | 1009 | Toilet Clog               | Piece   | $3.45   |   13 | $44.85     | 2021-05-06 | Louisiana  |
-- | 20210331-01-01 | 1039 | Electric outlets/switch   | Piece   | $2.00   |   25 | $50.00     | 2021-05-07 | Louisiana  |
-- | 20210331-01-01 | 1003 | Replace Door Chimes       | Service | $25.00  |   21 | $525.00    | 2021-05-10 | Louisiana  |
-- | 20210331-01-01 | 1002 | Repair Door knobs in Apt. | Service | $4.00   |   27 | $108.00    | 2021-05-11 | Louisiana  |
-- | 20210331-01-01 | 1013 | Sink clog                 | Piece   | $2.00   |   10 | $20.00     | 2021-05-12 | Louisiana  |
-- | 20210331-01-01 | 1027 | New Kitchen Sink          | Piece   | $180.00 |   18 | $3,240.00  | 2021-05-14 | Louisiana  |
-- | 20210331-01-01 | 1015 | Toilet Seat replacement   | Piece   | $18.00  |   25 | $450.00    | 2021-05-15 | Louisiana  |
-- | 20210331-01-01 | 1023 | Bathroom sink faucet      | Piece   | $3.50   |   22 | $77.00     | 2021-05-16 | Louisiana  |
-- | 20210331-01-01 | 1042 | Circleline bulbs          | Piece   | $8.00   |   18 | $144.00    | 2021-05-18 | Louisiana  |
-- | 20210331-01-01 | 1021 | Shower Head               | Piece   | $10.00  |   13 | $130.00    | 2021-05-19 | Louisiana  |
-- | 20210331-01-01 | 1017 | Towel Bar                 | Piece   | $20.00  |   11 | $220.00    | 2021-05-21 | Louisiana  |
-- | 20210331-01-01 | 1028 | Kitchen Strainer assembly | Piece   | $25.00  |   27 | $675.00    | 2021-05-22 | Louisiana  |
-- | 20210331-01-01 | 1010 | Remova...owl)             | Service | $50.00  |   36 | $1,800.00  | 2021-05-24 | Louisiana  |
-- | 20210331-01-01 | 1043 | Bathro...ture             | Piece   | $25.00  |   30 | $750.00    | 2021-05-26 | Louisiana  |
-- | 20210331-01-01 | 1008 | Replace Mailbox lock      | Service | $4.50   |   22 | $99.00     | 2021-05-27 | Louisiana  |
-- | 20210331-01-01 | 1019 | Replace medicine chest    | Service | $15.00  |   24 | $360.00    | 2021-05-28 | Louisiana  |
-- | 20210331-01-01 | 1022 | Shower Body Handles       | Piece   | $1.00   |   21 | $21.00     | 2021-05-29 | Louisiana  |
-- | 20210331-01-01 | 1040 | Electr...ates             | Piece   | $2.00   |   31 | $62.00     | 2021-05-30 | Louisiana  |
-- | 20210331-01-02 | 1030 | Formic...ches             | Piece   | $80.00  |   34 | $2,720.00  | 2021-06-01 | Florida    |
-- | 20210331-01-02 | 1008 | Replace Mailbox lock      | Service | $4.50   |   22 | $99.00     | 2021-06-02 | Florida    |
-- | 20210331-01-02 | 1018 | Toilet Paper Holder       | Piece   | $23.00  |   21 | $483.00    | 2021-06-03 | Florida    |
-- | 20210331-01-02 | 1039 | Electric outlets/switch   | Piece   | $2.00   |   25 | $50.00     | 2021-06-05 | Florida    |
-- | 20210331-01-02 | 1042 | Circleline bulbs          | Piece   | $8.00   |   18 | $144.00    | 2021-06-06 | Florida    |
-- :
-- :
-- | 20220330-02-27 | 4026 | Kitchen sink faucet       | Piece   | $3.25   |   20 | $65.00     | 2022-12-01 | Arizona    |
-- | 20220325-01-07 | 2046 | Floor Tiles               | Piece   | $2.75   |   12 | $33.00     | 2022-12-01 | Louisiana  |
-- | 20220329-01-18 | 3030 | Kitche...self             | Piece   | $9.00   |   29 | $261.00    | 2022-12-01 | Montana    |
-- | 20220329-01-16 | 3032 | Formic...ches             | Piece   | $301.00 |   34 | $10,234.00 | 2022-12-01 | oregon     |
-- | 20220325-01-09 | 2023 | Shower Body Handles       | Piece   | $2.00   |   22 | $44.00     | 2022-12-01 | Tennessee  |
-- | 20220330-02-26 | 4004 | Replace Door Chimes       | Service | $26.00  |   20 | $520.00    | 2022-12-01 | Utah       |
-- | 20220330-02-25 | 4037 | Replace Cabinet Doors     | Service | $21.00  |   24 | $504.00    | 2022-12-02 | California |
-- | 20220329-01-17 | 3006 | Replac...oor)             | Service | $61.00  |   36 | $2,196.00  | 2022-12-02 | Idaho      |
-- | 20220325-01-07 | 2001 | Cylind...nly)             | Service | $16.00  |   36 | $576.00    | 2022-12-02 | Louisiana  |
-- | 20220329-01-18 | 3016 | Toilet Seat replacement   | Piece   | $19.00  |   24 | $456.00    | 2022-12-02 | Montana    |
-- | 20220325-01-09 | 2043 | Circleline bulbs          | Piece   | $9.00   |   19 | $171.00    | 2022-12-02 | Tennessee  |
-- | 20220330-02-26 | 4017 | Soap D...lder             | Piece   | $26.00  |   33 | $858.00    | 2022-12-02 | Utah       |
-- | 20220330-02-27 | 4044 | Bathro...ture             | Piece   | $26.00  |   29 | $754.00    | 2022-12-03 | Arizona    |
-- | 20220325-01-08 | 2029 | Kitchen Strainer assembly | Piece   | $26.00  |   28 | $728.00    | 2022-12-03 | Florida    |
-- | 20220325-01-07 | 2014 | Sink clog                 | Piece   | $3.00   |    9 | $27.00     | 2022-12-03 | Louisiana  |
-- | 20220329-01-18 | 3040 | Electric outlets/switch   | Piece   | $3.00   |   24 | $72.00     | 2022-12-03 | Montana    |
-- | 20220329-01-16 | 3011 | Remova...owl)             | Service | $51.00  |   37 | $1,887.00  | 2022-12-03 | oregon     |
-- | 20220330-02-26 | 4008 | Replace terrace door lock | Service | $6.25   |   26 | $162.50    | 2022-12-03 | Utah       |
-- | 20220325-01-08 | 2012 | Replac...ilet             | Service | $136.00 |   31 | $4,216.00  | 2022-12-04 | Florida    |
-- | 20220329-01-17 | 3011 | Remova...owl)             | Service | $51.00  |   37 | $1,887.00  | 2022-12-04 | Idaho      |
-- | 20220325-01-07 | 2016 | Toilet Seat replacement   | Piece   | $19.00  |   24 | $456.00    | 2022-12-04 | Louisiana  |
-- | 20220329-01-18 | 3017 | Soap D...lder             | Piece   | $26.00  |   33 | $858.00    | 2022-12-04 | Montana    |
-- | 20220330-02-26 | 4035 | Kitche...ches             | Piece   | $76.00  |   36 | $2,736.00  | 2022-12-04 | Utah       |
-- | 20220330-02-27 | 4025 | Bathroom sink handles     | Piece   | $2.80   |   24 | $67.20     | 2022-12-05 | Arizona    |
-- | 20220325-01-08 | 2043 | Circleline bulbs          | Piece   | $9.00   |   19 | $171.00    | 2022-12-05 | Florida    |
-- | 20220329-01-17 | 3029 | Kitchen Strainer assembly | Piece   | $26.00  |   28 | $728.00    | 2022-12-05 | Idaho      |
-- | 20220329-01-18 | 3012 | Replac...ilet             | Service | $136.00 |   31 | $4,216.00  | 2022-12-05 | Montana    |
-- | 20220325-01-09 | 2004 | Replace Door Chimes       | Service | $26.00  |   20 | $520.00    | 2022-12-05 | Tennessee  |
-- | 20220330-02-26 | 4030 | Kitche...self             | Piece   | $9.00   |   29 | $261.00    | 2022-12-05 | Utah       |
-- | 20220330-02-27 | 4016 | Toilet Seat replacement   | Piece   | $19.00  |   24 | $456.00    | 2022-12-06 | Arizona    |
-- | 20220329-01-17 | 3004 | Replace Door Chimes       | Service | $26.00  |   20 | $520.00    | 2022-12-06 | Idaho      |
-- | 20220325-01-07 | 2017 | Soap D...lder             | Piece   | $26.00  |   33 | $858.00    | 2022-12-06 | Louisiana  |
-- | 20220329-01-18 | 3020 | Replace medicine chest    | Service | $16.00  |   23 | $368.00    | 2022-12-06 | Montana    |
-- | 20220329-01-16 | 3039 | Repair Cabinet Drawers    | Service | $16.00  |   25 | $400.00    | 2022-12-06 | oregon     |
-- | 20220325-01-09 | 2001 | Cylind...nly)             | Service | $16.00  |   36 | $576.00    | 2022-12-06 | Tennessee  |
-- | 20220330-02-26 | 4015 | Sink c...clog             | Piece   | $21.00  |   42 | $882.00    | 2022-12-06 | Utah       |
-- | 20220330-02-25 | 4035 | Kitche...ches             | Piece   | $76.00  |   36 | $2,736.00  | 2022-12-07 | California |
-- | 20220325-01-08 | 2019 | Toilet Paper Holder       | Piece   | $24.00  |   22 | $528.00    | 2022-12-07 | Florida    |
-- | 20220329-01-18 | 3036 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-07 | Montana    |
-- | 20220329-01-16 | 3008 | Replace terrace door lock | Service | $6.25   |   26 | $162.50    | 2022-12-07 | oregon     |
-- | 20220325-01-09 | 2028 | New Kitchen Sink          | Piece   | $181.00 |   17 | $3,077.00  | 2022-12-07 | Tennessee  |
-- | 20220330-02-27 | 4027 | Kitchen sink handles      | Piece   | $2.80   |   23 | $64.40     | 2022-12-08 | Arizona    |
-- | 20220330-02-25 | 4029 | Kitchen Strainer assembly | Piece   | $26.00  |   28 | $728.00    | 2022-12-08 | California |
-- | 20220325-01-08 | 2037 | Replace Cabinet Doors     | Service | $21.00  |   24 | $504.00    | 2022-12-08 | Florida    |
-- | 20220329-01-17 | 3033 | Kitche...ches             | Piece   | $86.00  |   37 | $3,182.00  | 2022-12-08 | Idaho      |
-- | 20220329-01-18 | 3037 | Replace Cabinet Doors     | Service | $21.00  |   24 | $504.00    | 2022-12-08 | Montana    |
-- | 20220329-01-16 | 3033 | Kitche...ches             | Piece   | $86.00  |   37 | $3,182.00  | 2022-12-08 | oregon     |
-- | 20220330-02-26 | 4019 | Toilet Paper Holder       | Piece   | $24.00  |   22 | $528.00    | 2022-12-08 | Utah       |
-- | 20220325-01-08 | 2006 | Replac...oor)             | Service | $61.00  |   36 | $2,196.00  | 2022-12-09 | Florida    |
-- | 20220325-01-07 | 2025 | Bathroom sink handles     | Piece   | $2.80   |   24 | $67.20     | 2022-12-09 | Louisiana  |
-- | 20220329-01-18 | 3002 | Replace Apt. door knobs   | Service | $13.00  |   24 | $312.00    | 2022-12-09 | Montana    |
-- | 20220329-01-16 | 3021 | Medicine cabinet shelves  | Piece   | $2.00   |   27 | $54.00     | 2022-12-09 | oregon     |
-- | 20220325-01-09 | 2009 | Replace Mailbox lock      | Service | $5.50   |   23 | $126.50    | 2022-12-09 | Tennessee  |
-- | 20220330-02-27 | 4035 | Kitche...ches             | Piece   | $76.00  |   36 | $2,736.00  | 2022-12-10 | Arizona    |
-- | 20220330-02-25 | 4007 | Realign Sliding Doors     | Service | $3.00   |   24 | $72.00     | 2022-12-10 | California |
-- | 20220325-01-07 | 2021 | Medicine cabinet shelves  | Piece   | $2.00   |   27 | $54.00     | 2022-12-10 | Louisiana  |
-- | 20220329-01-16 | 3017 | Soap D...lder             | Piece   | $26.00  |   33 | $858.00    | 2022-12-10 | oregon     |
-- | 20220325-01-09 | 2007 | Realign Sliding Doors     | Service | $3.00   |   24 | $72.00     | 2022-12-10 | Tennessee  |
-- | 20220330-02-26 | 4029 | Kitchen Strainer assembly | Piece   | $26.00  |   28 | $728.00    | 2022-12-10 | Utah       |
-- | 20220330-02-27 | 4001 | Cylind...nly)             | Service | $16.00  |   36 | $576.00    | 2022-12-11 | Arizona    |
-- | 20220330-02-25 | 4008 | Replace terrace door lock | Service | $6.25   |   26 | $162.50    | 2022-12-11 | California |
-- | 20220325-01-08 | 2013 | Bathtub clog              | Piece   | $4.00   |   15 | $60.00     | 2022-12-11 | Florida    |
-- | 20220329-01-17 | 3007 | Realign Sliding Doors     | Service | $3.00   |   24 | $72.00     | 2022-12-11 | Idaho      |
-- | 20220329-01-18 | 3041 | Electr...ates             | Piece   | $3.00   |   32 | $96.00     | 2022-12-11 | Montana    |
-- | 20220329-01-16 | 3022 | Shower Head               | Piece   | $11.00  |   12 | $132.00    | 2022-12-11 | oregon     |
-- | 20220325-01-09 | 2017 | Soap D...lder             | Piece   | $26.00  |   33 | $858.00    | 2022-12-11 | Tennessee  |
-- | 20220330-02-27 | 4006 | Replac...oor)             | Service | $61.00  |   36 | $2,196.00  | 2022-12-12 | Arizona    |
-- | 20220325-01-08 | 2032 | Formic...ches             | Piece   | $301.00 |   34 | $10,234.00 | 2022-12-12 | Florida    |
-- | 20220329-01-17 | 3040 | Electric outlets/switch   | Piece   | $3.00   |   24 | $72.00     | 2022-12-12 | Idaho      |
-- | 20220325-01-07 | 2027 | Kitchen sink handles      | Piece   | $2.80   |   23 | $64.40     | 2022-12-12 | Louisiana  |
-- | 20220329-01-16 | 3042 | Circle...ture             | Piece   | $26.00  |   27 | $702.00    | 2022-12-12 | oregon     |
-- | 20220325-01-09 | 2006 | Replac...oor)             | Service | $61.00  |   36 | $2,196.00  | 2022-12-12 | Tennessee  |
-- | 20220330-02-26 | 4006 | Replac...oor)             | Service | $61.00  |   36 | $2,196.00  | 2022-12-12 | Utah       |
-- | 20220330-02-27 | 4020 | Replace medicine chest    | Service | $16.00  |   23 | $368.00    | 2022-12-13 | Arizona    |
-- | 20220330-02-25 | 4025 | Bathroom sink handles     | Piece   | $2.80   |   24 | $67.20     | 2022-12-13 | California |
-- | 20220325-01-08 | 2026 | Kitchen sink faucet       | Piece   | $3.25   |   20 | $65.00     | 2022-12-13 | Florida    |
-- | 20220329-01-17 | 3023 | Shower Body Handles       | Piece   | $2.00   |   22 | $44.00     | 2022-12-13 | Idaho      |
-- | 20220325-01-07 | 2003 | Repair Door knobs in Apt. | Service | $5.00   |   28 | $140.00    | 2022-12-13 | Louisiana  |
-- | 20220329-01-16 | 3030 | Kitche...self             | Piece   | $9.00   |   29 | $261.00    | 2022-12-13 | oregon     |
-- | 20220325-01-09 | 2038 | Replace Cabinet Drawers   | Service | $26.00  |   24 | $624.00    | 2022-12-13 | Tennessee  |
-- | 20220330-02-26 | 4018 | Towel Bar                 | Piece   | $21.00  |   10 | $210.00    | 2022-12-13 | Utah       |
-- | 20220330-02-27 | 4046 | Floor Tiles               | Piece   | $2.75   |   12 | $33.00     | 2022-12-14 | Arizona    |
-- | 20220329-01-17 | 3015 | Sink c...clog             | Piece   | $21.00  |   42 | $882.00    | 2022-12-14 | Idaho      |
-- | 20220325-01-07 | 2036 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-14 | Louisiana  |
-- | 20220329-01-16 | 3005 | Repair room doors         | Service | $7.00   |   20 | $140.00    | 2022-12-14 | oregon     |
-- | 20220325-01-09 | 2044 | Bathro...ture             | Piece   | $26.00  |   29 | $754.00    | 2022-12-14 | Tennessee  |
-- | 20220330-02-25 | 4018 | Towel Bar                 | Piece   | $21.00  |   10 | $210.00    | 2022-12-15 | California |
-- | 20220325-01-08 | 2036 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-15 | Florida    |
-- | 20220329-01-17 | 3026 | Kitchen sink faucet       | Piece   | $3.25   |   20 | $65.00     | 2022-12-15 | Idaho      |
-- | 20220325-01-07 | 2013 | Bathtub clog              | Piece   | $4.00   |   15 | $60.00     | 2022-12-15 | Louisiana  |
-- | 20220325-01-09 | 2003 | Repair Door knobs in Apt. | Service | $5.00   |   28 | $140.00    | 2022-12-15 | Tennessee  |
-- | 20220330-02-26 | 4009 | Replace Mailbox lock      | Service | $5.50   |   23 | $126.50    | 2022-12-15 | Utah       |
-- | 20220330-02-27 | 4021 | Medicine cabinet shelves  | Piece   | $2.00   |   27 | $54.00     | 2022-12-16 | Arizona    |
-- | 20220330-02-25 | 4024 | Bathroom sink faucet      | Piece   | $4.50   |   21 | $94.50     | 2022-12-16 | California |
-- | 20220325-01-08 | 2003 | Repair Door knobs in Apt. | Service | $5.00   |   28 | $140.00    | 2022-12-16 | Florida    |
-- | 20220329-01-17 | 3044 | Bathro...ture             | Piece   | $26.00  |   29 | $754.00    | 2022-12-16 | Idaho      |
-- | 20220325-01-07 | 2028 | New Kitchen Sink          | Piece   | $181.00 |   17 | $3,077.00  | 2022-12-16 | Louisiana  |
-- | 20220329-01-18 | 3033 | Kitche...ches             | Piece   | $86.00  |   37 | $3,182.00  | 2022-12-16 | Montana    |
-- | 20220329-01-16 | 3035 | Kitche...ches             | Piece   | $76.00  |   36 | $2,736.00  | 2022-12-16 | oregon     |
-- | 20220325-01-09 | 2022 | Shower Head               | Piece   | $11.00  |   12 | $132.00    | 2022-12-16 | Tennessee  |
-- | 20220330-02-26 | 4045 | Dinette Light Fixture     | Piece   | $36.00  |   24 | $864.00    | 2022-12-16 | Utah       |
-- | 20220330-02-27 | 4004 | Replace Door Chimes       | Service | $26.00  |   20 | $520.00    | 2022-12-17 | Arizona    |
-- | 20220330-02-25 | 4010 | Toilet Clog               | Piece   | $4.45   |   12 | $53.40     | 2022-12-17 | California |
-- | 20220325-01-08 | 2040 | Electric outlets/switch   | Piece   | $3.00   |   24 | $72.00     | 2022-12-17 | Florida    |
-- | 20220329-01-17 | 3030 | Kitche...self             | Piece   | $9.00   |   29 | $261.00    | 2022-12-17 | Idaho      |
-- | 20220325-01-07 | 2024 | Bathroom sink faucet      | Piece   | $4.50   |   21 | $94.50     | 2022-12-17 | Louisiana  |
-- | 20220329-01-18 | 3028 | New Kitchen Sink          | Piece   | $181.00 |   17 | $3,077.00  | 2022-12-17 | Montana    |
-- | 20220329-01-16 | 3014 | Sink clog                 | Piece   | $3.00   |    9 | $27.00     | 2022-12-17 | oregon     |
-- | 20220330-02-26 | 4026 | Kitchen sink faucet       | Piece   | $3.25   |   20 | $65.00     | 2022-12-17 | Utah       |
-- | 20220330-02-27 | 4041 | Electr...ates             | Piece   | $3.00   |   32 | $96.00     | 2022-12-18 | Arizona    |
-- | 20220325-01-08 | 2030 | Kitche...self             | Piece   | $9.00   |   29 | $261.00    | 2022-12-18 | Florida    |
-- | 20220329-01-17 | 2046 | Floor Tiles               | Piece   | $2.75   |   12 | $33.00     | 2022-12-18 | Idaho      |
-- | 20220325-01-07 | 2007 | Realign Sliding Doors     | Service | $3.00   |   24 | $72.00     | 2022-12-18 | Louisiana  |
-- | 20220329-01-18 | 3042 | Circle...ture             | Piece   | $26.00  |   27 | $702.00    | 2022-12-18 | Montana    |
-- | 20220329-01-16 | 3007 | Realign Sliding Doors     | Service | $3.00   |   24 | $72.00     | 2022-12-18 | oregon     |
-- | 20220325-01-09 | 2036 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-18 | Tennessee  |
-- | 20220330-02-26 | 4033 | Kitche...ches             | Piece   | $86.00  |   37 | $3,182.00  | 2022-12-18 | Utah       |
-- | 20220330-02-25 | 4012 | Replac...ilet             | Service | $136.00 |   31 | $4,216.00  | 2022-12-19 | California |
-- | 20220325-01-08 | 2009 | Replace Mailbox lock      | Service | $5.50   |   23 | $126.50    | 2022-12-19 | Florida    |
-- | 20220329-01-17 | 3035 | Kitche...ches             | Piece   | $76.00  |   36 | $2,736.00  | 2022-12-19 | Idaho      |
-- | 20220325-01-07 | 2012 | Replac...ilet             | Service | $136.00 |   31 | $4,216.00  | 2022-12-19 | Louisiana  |
-- | 20220329-01-18 | 3035 | Kitche...ches             | Piece   | $76.00  |   36 | $2,736.00  | 2022-12-19 | Montana    |
-- | 20220329-01-16 | 2046 | Floor Tiles               | Piece   | $2.75   |   12 | $33.00     | 2022-12-19 | oregon     |
-- | 20220325-01-09 | 2039 | Repair Cabinet Drawers    | Service | $16.00  |   25 | $400.00    | 2022-12-19 | Tennessee  |
-- | 20220330-02-25 | 4020 | Replace medicine chest    | Service | $16.00  |   23 | $368.00    | 2022-12-20 | California |
-- | 20220325-01-08 | 2007 | Realign Sliding Doors     | Service | $3.00   |   24 | $72.00     | 2022-12-20 | Florida    |
-- | 20220329-01-17 | 3043 | Circleline bulbs          | Piece   | $9.00   |   19 | $171.00    | 2022-12-20 | Idaho      |
-- | 20220325-01-07 | 2005 | Repair room doors         | Service | $7.00   |   20 | $140.00    | 2022-12-20 | Louisiana  |
-- | 20220329-01-18 | 3024 | Bathroom sink faucet      | Piece   | $4.50   |   21 | $94.50     | 2022-12-20 | Montana    |
-- | 20220329-01-16 | 3046 | Floor Tiles               | Piece   | $2.75   |   12 | $33.00     | 2022-12-20 | oregon     |
-- | 20220325-01-09 | 2020 | Replace medicine chest    | Service | $16.00  |   23 | $368.00    | 2022-12-20 | Tennessee  |
-- | 20220330-02-27 | 4010 | Toilet Clog               | Piece   | $4.45   |   12 | $53.40     | 2022-12-21 | Arizona    |
-- | 20220330-02-25 | 4003 | Repair Door knobs in Apt. | Service | $5.00   |   28 | $140.00    | 2022-12-21 | California |
-- | 20220325-01-08 | 2045 | Dinette Light Fixture     | Piece   | $36.00  |   24 | $864.00    | 2022-12-21 | Florida    |
-- | 20220329-01-17 | 3024 | Bathroom sink faucet      | Piece   | $4.50   |   21 | $94.50     | 2022-12-21 | Idaho      |
-- | 20220325-01-07 | 2042 | Circle...ture             | Piece   | $26.00  |   27 | $702.00    | 2022-12-21 | Louisiana  |
-- | 20220329-01-18 | 3003 | Repair Door knobs in Apt. | Service | $5.00   |   28 | $140.00    | 2022-12-21 | Montana    |
-- | 20220329-01-16 | 3031 | Formic...ches             | Piece   | $81.00  |   35 | $2,835.00  | 2022-12-21 | oregon     |
-- | 20220325-01-09 | 2041 | Electr...ates             | Piece   | $3.00   |   32 | $96.00     | 2022-12-21 | Tennessee  |
-- | 20220330-02-26 | 4010 | Toilet Clog               | Piece   | $4.45   |   12 | $53.40     | 2022-12-21 | Utah       |
-- | 20220330-02-27 | 4008 | Replace terrace door lock | Service | $6.25   |   26 | $162.50    | 2022-12-22 | Arizona    |
-- | 20220330-02-25 | 4011 | Remova...owl)             | Service | $51.00  |   37 | $1,887.00  | 2022-12-22 | California |
-- | 20220325-01-08 | 2042 | Circle...ture             | Piece   | $26.00  |   27 | $702.00    | 2022-12-22 | Florida    |
-- | 20220329-01-17 | 3037 | Replace Cabinet Doors     | Service | $21.00  |   24 | $504.00    | 2022-12-22 | Idaho      |
-- | 20220325-01-07 | 2034 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-22 | Louisiana  |
-- | 20220329-01-18 | 3005 | Repair room doors         | Service | $7.00   |   20 | $140.00    | 2022-12-22 | Montana    |
-- | 20220330-02-26 | 4023 | Shower Body Handles       | Piece   | $2.00   |   22 | $44.00     | 2022-12-22 | Utah       |
-- | 20220330-02-25 | 4034 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-23 | California |
-- | 20220329-01-17 | 3017 | Soap D...lder             | Piece   | $26.00  |   33 | $858.00    | 2022-12-23 | Idaho      |
-- | 20220325-01-07 | 2044 | Bathro...ture             | Piece   | $26.00  |   29 | $754.00    | 2022-12-23 | Louisiana  |
-- | 20220329-01-18 | 3014 | Sink clog                 | Piece   | $3.00   |    9 | $27.00     | 2022-12-23 | Montana    |
-- | 20220329-01-16 | 3024 | Bathroom sink faucet      | Piece   | $4.50   |   21 | $94.50     | 2022-12-23 | oregon     |
-- | 20220330-02-26 | 4007 | Realign Sliding Doors     | Service | $3.00   |   24 | $72.00     | 2022-12-23 | Utah       |
-- | 20220330-02-27 | 4029 | Kitchen Strainer assembly | Piece   | $26.00  |   28 | $728.00    | 2022-12-24 | Arizona    |
-- | 20220330-02-25 | 4028 | New Kitchen Sink          | Piece   | $181.00 |   17 | $3,077.00  | 2022-12-24 | California |
-- | 20220325-01-08 | 2005 | Repair room doors         | Service | $7.00   |   20 | $140.00    | 2022-12-24 | Florida    |
-- | 20220329-01-17 | 3036 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-24 | Idaho      |
-- | 20220325-01-07 | 2038 | Replace Cabinet Drawers   | Service | $26.00  |   24 | $624.00    | 2022-12-24 | Louisiana  |
-- | 20220329-01-18 | 3011 | Remova...owl)             | Service | $51.00  |   37 | $1,887.00  | 2022-12-24 | Montana    |
-- | 20220329-01-16 | 3028 | New Kitchen Sink          | Piece   | $181.00 |   17 | $3,077.00  | 2022-12-24 | oregon     |
-- | 20220325-01-09 | 2014 | Sink clog                 | Piece   | $3.00   |    9 | $27.00     | 2022-12-24 | Tennessee  |
-- | 20220330-02-26 | 4011 | Remova...owl)             | Service | $51.00  |   37 | $1,887.00  | 2022-12-24 | Utah       |
-- | 20220330-02-27 | 4038 | Replace Cabinet Drawers   | Service | $26.00  |   24 | $624.00    | 2022-12-25 | Arizona    |
-- | 20220330-02-25 | 4004 | Replace Door Chimes       | Service | $26.00  |   20 | $520.00    | 2022-12-25 | California |
-- | 20220325-01-08 | 2014 | Sink clog                 | Piece   | $3.00   |    9 | $27.00     | 2022-12-25 | Florida    |
-- | 20220325-01-07 | 2008 | Replace terrace door lock | Service | $6.25   |   26 | $162.50    | 2022-12-25 | Louisiana  |
-- | 20220329-01-18 | 3008 | Replace terrace door lock | Service | $6.25   |   26 | $162.50    | 2022-12-25 | Montana    |
-- | 20220329-01-16 | 3026 | Kitchen sink faucet       | Piece   | $3.25   |   20 | $65.00     | 2022-12-25 | oregon     |
-- | 20220325-01-09 | 2011 | Remova...owl)             | Service | $51.00  |   37 | $1,887.00  | 2022-12-25 | Tennessee  |
-- | 20220330-02-26 | 4036 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-25 | Utah       |
-- | 20220330-02-27 | 4023 | Shower Body Handles       | Piece   | $2.00   |   22 | $44.00     | 2022-12-26 | Arizona    |
-- | 20220330-02-25 | 4021 | Medicine cabinet shelves  | Piece   | $2.00   |   27 | $54.00     | 2022-12-26 | California |
-- | 20220325-01-08 | 2034 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-26 | Florida    |
-- | 20220329-01-17 | 3038 | Replace Cabinet Drawers   | Service | $26.00  |   24 | $624.00    | 2022-12-26 | Idaho      |
-- | 20220325-01-07 | 2032 | Formic...ches             | Piece   | $301.00 |   34 | $10,234.00 | 2022-12-26 | Louisiana  |
-- | 20220329-01-18 | 3023 | Shower Body Handles       | Piece   | $2.00   |   22 | $44.00     | 2022-12-26 | Montana    |
-- | 20220329-01-16 | 3038 | Replace Cabinet Drawers   | Service | $26.00  |   24 | $624.00    | 2022-12-26 | oregon     |
-- | 20220325-01-09 | 2030 | Kitche...self             | Piece   | $9.00   |   29 | $261.00    | 2022-12-26 | Tennessee  |
-- | 20220330-02-26 | 4034 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-26 | Utah       |
-- | 20220330-02-27 | 4043 | Circleline bulbs          | Piece   | $9.00   |   19 | $171.00    | 2022-12-27 | Arizona    |
-- | 20220330-02-25 | 4027 | Kitchen sink handles      | Piece   | $2.80   |   23 | $64.40     | 2022-12-27 | California |
-- | 20220325-01-08 | 2022 | Shower Head               | Piece   | $11.00  |   12 | $132.00    | 2022-12-27 | Florida    |
-- | 20220329-01-17 | 3019 | Toilet Paper Holder       | Piece   | $24.00  |   22 | $528.00    | 2022-12-27 | Idaho      |
-- | 20220325-01-07 | 2041 | Electr...ates             | Piece   | $3.00   |   32 | $96.00     | 2022-12-27 | Louisiana  |
-- | 20220329-01-18 | 3018 | Towel Bar                 | Piece   | $21.00  |   10 | $210.00    | 2022-12-27 | Montana    |
-- | 20220329-01-16 | 3025 | Bathroom sink handles     | Piece   | $2.80   |   24 | $67.20     | 2022-12-27 | oregon     |
-- | 20220325-01-09 | 2040 | Electric outlets/switch   | Piece   | $3.00   |   24 | $72.00     | 2022-12-27 | Tennessee  |
-- | 20220330-02-26 | 4031 | Formic...ches             | Piece   | $81.00  |   35 | $2,835.00  | 2022-12-27 | Utah       |
-- | 20220330-02-27 | 4013 | Bathtub clog              | Piece   | $4.00   |   15 | $60.00     | 2022-12-28 | Arizona    |
-- | 20220330-02-25 | 4041 | Electr...ates             | Piece   | $3.00   |   32 | $96.00     | 2022-12-28 | California |
-- | 20220325-01-08 | 2011 | Remova...owl)             | Service | $51.00  |   37 | $1,887.00  | 2022-12-28 | Florida    |
-- | 20220329-01-17 | 3009 | Replace Mailbox lock      | Service | $5.50   |   23 | $126.50    | 2022-12-28 | Idaho      |
-- | 20220325-01-07 | 2029 | Kitchen Strainer assembly | Piece   | $26.00  |   28 | $728.00    | 2022-12-28 | Louisiana  |
-- | 20220329-01-18 | 3025 | Bathroom sink handles     | Piece   | $2.80   |   24 | $67.20     | 2022-12-28 | Montana    |
-- | 20220329-01-16 | 3043 | Circleline bulbs          | Piece   | $9.00   |   19 | $171.00    | 2022-12-28 | oregon     |
-- | 20220325-01-09 | 2016 | Toilet Seat replacement   | Piece   | $19.00  |   24 | $456.00    | 2022-12-28 | Tennessee  |
-- | 20220330-02-26 | 4042 | Circle...ture             | Piece   | $26.00  |   27 | $702.00    | 2022-12-28 | Utah       |
-- | 20220330-02-27 | 4005 | Repair room doors         | Service | $7.00   |   20 | $140.00    | 2022-12-29 | Arizona    |
-- | 20220330-02-25 | 4042 | Circle...ture             | Piece   | $26.00  |   27 | $702.00    | 2022-12-29 | California |
-- | 20220325-01-08 | 2044 | Bathro...ture             | Piece   | $26.00  |   29 | $754.00    | 2022-12-29 | Florida    |
-- | 20220329-01-17 | 3022 | Shower Head               | Piece   | $11.00  |   12 | $132.00    | 2022-12-29 | Idaho      |
-- | 20220325-01-07 | 2011 | Remova...owl)             | Service | $51.00  |   37 | $1,887.00  | 2022-12-29 | Louisiana  |
-- | 20220329-01-18 | 3046 | Floor Tiles               | Piece   | $2.75   |   12 | $33.00     | 2022-12-29 | Montana    |
-- | 20220329-01-16 | 3036 | Kitche...ches             | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-29 | oregon     |
-- | 20220325-01-09 | 2024 | Bathroom sink faucet      | Piece   | $4.50   |   21 | $94.50     | 2022-12-29 | Tennessee  |
-- | 20220330-02-26 | 4013 | Bathtub clog              | Piece   | $4.00   |   15 | $60.00     | 2022-12-29 | Utah       |
-- | 20220330-02-27 | 4019 | Toilet Paper Holder       | Piece   | $24.00  |   22 | $528.00    | 2022-12-30 | Arizona    |
-- | 20220330-02-25 | 4044 | Bathro...ture             | Piece   | $26.00  |   29 | $754.00    | 2022-12-30 | California |
-- | 20220325-01-08 | 2027 | Kitchen sink handles      | Piece   | $2.80   |   23 | $64.40     | 2022-12-30 | Florida    |
-- | 20220329-01-17 | 3039 | Repair Cabinet Drawers    | Service | $16.00  |   25 | $400.00    | 2022-12-30 | Idaho      |
-- | 20220325-01-07 | 2030 | Kitche...self             | Piece   | $9.00   |   29 | $261.00    | 2022-12-30 | Louisiana  |
-- | 20220329-01-18 | 3032 | Formic...ches             | Piece   | $301.00 |   34 | $10,234.00 | 2022-12-30 | Montana    |
-- | 20220329-01-16 | 3004 | Replace Door Chimes       | Service | $26.00  |   20 | $520.00    | 2022-12-30 | oregon     |
-- | 20220325-01-09 | 2045 | Dinette Light Fixture     | Piece   | $36.00  |   24 | $864.00    | 2022-12-30 | Tennessee  |
-- | 20220330-02-26 | 4037 | Replace Cabinet Doors     | Service | $21.00  |   24 | $504.00    | 2022-12-30 | Utah       |
-- +----------------+------+---------------------------+---------+---------+------+------------+------------+------------+
-- 843 rows in set (0.01 sec)

-- --------------------------------------------------------------------
-- The Business Purpose
-- --------------------------------------------------------------------
-- The client supersees the generator between a start-end 
-- and an end-date for  for each order.
-- --------------------------------------------------------------------


SELECT CONCAT(substr(r.tag_request,1,3), '..') request, 
c.tag_concept tag, CONCAT(substr(c.concept_name,1,6), '..') 
concept, c.unit, CONCAT('$',FORMAT(c.unit_price,2)) 'p/u',
c.quantity qnty, CONCAT('$',FORMAT(c.price,2)) price, 
g.exec_date, a.area_city, cc.contractor_personnel_name performed,
cl.client_personnel_name supersees
FROM generators g
INNER JOIN concepts c ON g.concept_id = c.concept_id
INNER JOIN requests r ON g.request_id = r.request_id
INNER JOIN areas a ON a.area_id = r.area_id
INNER JOIN contractor_personnel cc ON cc.contractor_personnel_id = g.client_personnel_id
INNER JOIN client_personnel cl ON cl.client_personnel_id = g.client_personnel_id
ORDER BY 8,9,1,2;

-- mysql> SELECT CONCAT(substr(r.tag_request,1,3), '..') request,
--     -> c.tag_concept tag, CONCAT(substr(c.concept_name,1,6), '..')
--     -> concept, c.unit, CONCAT('$',FORMAT(c.unit_price,2)) 'p/u',
--     -> c.quantity qnty, CONCAT('$',FORMAT(c.price,2)) price,
--     -> g.exec_date, a.area_city, cc.contractor_personnel_name performed,
--     -> cl.client_personnel_name supersees
--     -> FROM generators g
--     -> INNER JOIN concepts c ON g.concept_id = c.concept_id
--     -> INNER JOIN requests r ON g.request_id = r.request_id
--     -> INNER JOIN areas a ON a.area_id = r.area_id
--     -> INNER JOIN contractor_personnel cc ON cc.contractor_personnel_id = g.client_personnel_id
--     -> INNER JOIN client_personnel cl ON cl.client_personnel_id = g.client_personnel_id
--     -> ORDER BY 8,9,1,2;
-- +---------+------+----------+---------+---------+------+------------+------------+-----------+----------------+----------------+
-- | request | tag  | concept  | unit    | p/u     | qnty | price      | exec_date  | area_city | performed      | supersees      |
-- +---------+------+----------+---------+---------+------+------------+------------+-----------+----------------+----------------+
-- | 202..   | 1018 | Toilet.. | Piece   | $23.00  |   21 | $483.00    | 2021-05-01 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1001 | Replac.. | Service | $12.00  |   25 | $300.00    | 2021-05-02 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1031 | Formic.. | Piece   | $300.00 |   35 | $10,500.00 | 2021-05-04 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1037 | Replac.. | Service | $25.00  |   25 | $625.00    | 2021-05-05 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1009 | Toilet.. | Piece   | $3.45   |   13 | $44.85     | 2021-05-06 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1039 | Electr.. | Piece   | $2.00   |   25 | $50.00     | 2021-05-07 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1003 | Replac.. | Service | $25.00  |   21 | $525.00    | 2021-05-10 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1002 | Repair.. | Service | $4.00   |   27 | $108.00    | 2021-05-11 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1013 | Sink c.. | Piece   | $2.00   |   10 | $20.00     | 2021-05-12 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1027 | New Ki.. | Piece   | $180.00 |   18 | $3,240.00  | 2021-05-14 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1015 | Toilet.. | Piece   | $18.00  |   25 | $450.00    | 2021-05-15 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1023 | Bathro.. | Piece   | $3.50   |   22 | $77.00     | 2021-05-16 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1042 | Circle.. | Piece   | $8.00   |   18 | $144.00    | 2021-05-18 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1021 | Shower.. | Piece   | $10.00  |   13 | $130.00    | 2021-05-19 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1017 | Towel .. | Piece   | $20.00  |   11 | $220.00    | 2021-05-21 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1028 | Kitche.. | Piece   | $25.00  |   27 | $675.00    | 2021-05-22 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1010 | Remova.. | Service | $50.00  |   36 | $1,800.00  | 2021-05-24 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1043 | Bathro.. | Piece   | $25.00  |   30 | $750.00    | 2021-05-26 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1008 | Replac.. | Service | $4.50   |   22 | $99.00     | 2021-05-27 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1019 | Replac.. | Service | $15.00  |   24 | $360.00    | 2021-05-28 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1022 | Shower.. | Piece   | $1.00   |   21 | $21.00     | 2021-05-29 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1040 | Electr.. | Piece   | $2.00   |   31 | $62.00     | 2021-05-30 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 1030 | Formic.. | Piece   | $80.00  |   34 | $2,720.00  | 2021-06-01 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 1008 | Replac.. | Service | $4.50   |   22 | $99.00     | 2021-06-02 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 1018 | Toilet.. | Piece   | $23.00  |   21 | $483.00    | 2021-06-03 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 1039 | Electr.. | Piece   | $2.00   |   25 | $50.00     | 2021-06-05 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 1042 | Circle.. | Piece   | $8.00   |   18 | $144.00    | 2021-06-06 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 1013 | Sink c.. | Piece   | $2.00   |   10 | $20.00     | 2021-06-07 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 1019 | Replac.. | Service | $15.00  |   24 | $360.00    | 2021-06-09 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 1002 | Repair.. | Service | $4.00   |   27 | $108.00    | 2021-06-10 | Florida   | John Doe       | Brave Cardenas |
-- :
-- :
-- | 202..   | 2046 | Floor .. | Piece   | $2.75   |   12 | $33.00     | 2022-12-01 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2023 | Shower.. | Piece   | $2.00   |   22 | $44.00     | 2022-12-01 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2001 | Cylind.. | Service | $16.00  |   36 | $576.00    | 2022-12-02 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2043 | Circle.. | Piece   | $9.00   |   19 | $171.00    | 2022-12-02 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2029 | Kitche.. | Piece   | $26.00  |   28 | $728.00    | 2022-12-03 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2014 | Sink c.. | Piece   | $3.00   |    9 | $27.00     | 2022-12-03 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2012 | Replac.. | Service | $136.00 |   31 | $4,216.00  | 2022-12-04 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2016 | Toilet.. | Piece   | $19.00  |   24 | $456.00    | 2022-12-04 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2043 | Circle.. | Piece   | $9.00   |   19 | $171.00    | 2022-12-05 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2004 | Replac.. | Service | $26.00  |   20 | $520.00    | 2022-12-05 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2017 | Soap D.. | Piece   | $26.00  |   33 | $858.00    | 2022-12-06 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2001 | Cylind.. | Service | $16.00  |   36 | $576.00    | 2022-12-06 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2019 | Toilet.. | Piece   | $24.00  |   22 | $528.00    | 2022-12-07 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2028 | New Ki.. | Piece   | $181.00 |   17 | $3,077.00  | 2022-12-07 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2037 | Replac.. | Service | $21.00  |   24 | $504.00    | 2022-12-08 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2006 | Replac.. | Service | $61.00  |   36 | $2,196.00  | 2022-12-09 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2025 | Bathro.. | Piece   | $2.80   |   24 | $67.20     | 2022-12-09 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2009 | Replac.. | Service | $5.50   |   23 | $126.50    | 2022-12-09 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2021 | Medici.. | Piece   | $2.00   |   27 | $54.00     | 2022-12-10 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2007 | Realig.. | Service | $3.00   |   24 | $72.00     | 2022-12-10 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2013 | Bathtu.. | Piece   | $4.00   |   15 | $60.00     | 2022-12-11 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2017 | Soap D.. | Piece   | $26.00  |   33 | $858.00    | 2022-12-11 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2032 | Formic.. | Piece   | $301.00 |   34 | $10,234.00 | 2022-12-12 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2027 | Kitche.. | Piece   | $2.80   |   23 | $64.40     | 2022-12-12 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2006 | Replac.. | Service | $61.00  |   36 | $2,196.00  | 2022-12-12 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2026 | Kitche.. | Piece   | $3.25   |   20 | $65.00     | 2022-12-13 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2003 | Repair.. | Service | $5.00   |   28 | $140.00    | 2022-12-13 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2038 | Replac.. | Service | $26.00  |   24 | $624.00    | 2022-12-13 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2036 | Kitche.. | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-14 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2044 | Bathro.. | Piece   | $26.00  |   29 | $754.00    | 2022-12-14 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2036 | Kitche.. | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-15 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2013 | Bathtu.. | Piece   | $4.00   |   15 | $60.00     | 2022-12-15 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2003 | Repair.. | Service | $5.00   |   28 | $140.00    | 2022-12-15 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2003 | Repair.. | Service | $5.00   |   28 | $140.00    | 2022-12-16 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2028 | New Ki.. | Piece   | $181.00 |   17 | $3,077.00  | 2022-12-16 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2022 | Shower.. | Piece   | $11.00  |   12 | $132.00    | 2022-12-16 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2040 | Electr.. | Piece   | $3.00   |   24 | $72.00     | 2022-12-17 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2024 | Bathro.. | Piece   | $4.50   |   21 | $94.50     | 2022-12-17 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2030 | Kitche.. | Piece   | $9.00   |   29 | $261.00    | 2022-12-18 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2007 | Realig.. | Service | $3.00   |   24 | $72.00     | 2022-12-18 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2036 | Kitche.. | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-18 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2009 | Replac.. | Service | $5.50   |   23 | $126.50    | 2022-12-19 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2012 | Replac.. | Service | $136.00 |   31 | $4,216.00  | 2022-12-19 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2039 | Repair.. | Service | $16.00  |   25 | $400.00    | 2022-12-19 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2007 | Realig.. | Service | $3.00   |   24 | $72.00     | 2022-12-20 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2005 | Repair.. | Service | $7.00   |   20 | $140.00    | 2022-12-20 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2020 | Replac.. | Service | $16.00  |   23 | $368.00    | 2022-12-20 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2045 | Dinett.. | Piece   | $36.00  |   24 | $864.00    | 2022-12-21 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2042 | Circle.. | Piece   | $26.00  |   27 | $702.00    | 2022-12-21 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2041 | Electr.. | Piece   | $3.00   |   32 | $96.00     | 2022-12-21 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2042 | Circle.. | Piece   | $26.00  |   27 | $702.00    | 2022-12-22 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2034 | Kitche.. | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-22 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2044 | Bathro.. | Piece   | $26.00  |   29 | $754.00    | 2022-12-23 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2005 | Repair.. | Service | $7.00   |   20 | $140.00    | 2022-12-24 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2038 | Replac.. | Service | $26.00  |   24 | $624.00    | 2022-12-24 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2014 | Sink c.. | Piece   | $3.00   |    9 | $27.00     | 2022-12-24 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2014 | Sink c.. | Piece   | $3.00   |    9 | $27.00     | 2022-12-25 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2008 | Replac.. | Service | $6.25   |   26 | $162.50    | 2022-12-25 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2011 | Remova.. | Service | $51.00  |   37 | $1,887.00  | 2022-12-25 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2034 | Kitche.. | Piece   | $251.00 |   35 | $8,785.00  | 2022-12-26 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2032 | Formic.. | Piece   | $301.00 |   34 | $10,234.00 | 2022-12-26 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2030 | Kitche.. | Piece   | $9.00   |   29 | $261.00    | 2022-12-26 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2022 | Shower.. | Piece   | $11.00  |   12 | $132.00    | 2022-12-27 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2041 | Electr.. | Piece   | $3.00   |   32 | $96.00     | 2022-12-27 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2040 | Electr.. | Piece   | $3.00   |   24 | $72.00     | 2022-12-27 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2011 | Remova.. | Service | $51.00  |   37 | $1,887.00  | 2022-12-28 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2029 | Kitche.. | Piece   | $26.00  |   28 | $728.00    | 2022-12-28 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2016 | Toilet.. | Piece   | $19.00  |   24 | $456.00    | 2022-12-28 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2044 | Bathro.. | Piece   | $26.00  |   29 | $754.00    | 2022-12-29 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2011 | Remova.. | Service | $51.00  |   37 | $1,887.00  | 2022-12-29 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2024 | Bathro.. | Piece   | $4.50   |   21 | $94.50     | 2022-12-29 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- | 202..   | 2027 | Kitche.. | Piece   | $2.80   |   23 | $64.40     | 2022-12-30 | Florida   | John Doe       | Brave Cardenas |
-- | 202..   | 2030 | Kitche.. | Piece   | $9.00   |   29 | $261.00    | 2022-12-30 | Louisiana | Marya Phernand | Niguel Elarcon |
-- | 202..   | 2045 | Dinett.. | Piece   | $36.00  |   24 | $864.00    | 2022-12-30 | Tennessee | Ely Dahonri    | Urcid Antonio  |
-- +---------+------+----------+---------+---------+------+------------+------------+-----------+----------------+----------------+
-- 429 rows in set (0.01 sec)


-- --------------------------------------------------------------------
-- The Business Purpose
-- --------------------------------------------------------------------
-- With the order the contractor perform daily services in an area.    
-- A generator quantifies the concepts performed by the contractor 
-- and obtains the final cost for each order.
-- --------------------------------------------------------------------

SELECT r.tag_request request, r.start_date, 
r.end_date,CONCAT('$',FORMAT(SUM(c.price),2)) cost,
CONCAT(SUBSTR(MONTHNAME(g.exec_date),1,3),'-',YEAR(g.exec_date)) 
exec_date, a.area_city
FROM generators g
INNER JOIN concepts c ON g.concept_id = c.concept_id
INNER JOIN requests r ON g.request_id = r.request_id
INNER JOIN areas a ON a.area_id = r.area_id
WHERE YEAR(r.start_date) = YEAR(g.exec_date) AND 
MONTH(r.start_date) = MONTH(g.exec_date) 
AND a.area_id = r.area_id
GROUP BY r.tag_request
ORDER BY 2;

-- ysql> SELECT r.tag_request request, r.start_date,
--     -> r.end_date,CONCAT('$',FORMAT(SUM(c.price),2)) cost,
--     -> CONCAT(SUBSTR(MONTHNAME(g.exec_date),1,3),'-',YEAR(g.exec_date))
--     -> exec_date, a.area_city
--     -> FROM generators g
--     -> INNER JOIN concepts c ON g.concept_id = c.concept_id
--     -> INNER JOIN requests r ON g.request_id = r.request_id
--     -> INNER JOIN areas a ON a.area_id = r.area_id
--     -> WHERE YEAR(r.start_date) = YEAR(g.exec_date) AND
--     -> MONTH(r.start_date) = MONTH(g.exec_date)
--     -> AND a.area_id = r.area_id
--     -> GROUP BY r.tag_request
--     -> ORDER BY 2;
-- +----------------+------------+------------+------------+-----------+------------+
-- | request        | start_date | end_date   | cost       | exec_date | area_city  |
-- +----------------+------------+------------+------------+-----------+------------+
-- | 20210331-01-01 | 2021-05-01 | 2021-05-30 | $20,683.85 | May-2021  | Louisiana  |
-- | 20210331-01-02 | 2021-06-01 | 2021-06-30 | $35,448.60 | Jun-2021  | Florida    |
-- | 20210331-01-03 | 2021-07-01 | 2021-07-30 | $44,080.00 | Jul-2021  | Tennessee  |
-- | 20210331-01-04 | 2021-08-01 | 2021-08-30 | $15,950.75 | Aug-2021  | Louisiana  |
-- | 20210331-01-05 | 2021-09-01 | 2021-09-30 | $29,151.00 | Sep-2021  | Florida    |
-- | 20210331-01-06 | 2021-10-01 | 2021-10-30 | $40,542.60 | Oct-2021  | Tennessee  |
-- | 20210331-01-07 | 2021-11-01 | 2021-11-30 | $10,654.60 | Nov-2021  | Louisiana  |
-- | 20210331-01-08 | 2021-12-01 | 2021-12-30 | $27,399.15 | Dec-2021  | Florida    |
-- | 20210331-01-09 | 2021-12-01 | 2021-12-30 | $24,646.60 | Dec-2021  | Tennessee  |
-- | 20220329-01-10 | 2022-04-01 | 2022-04-30 | $19,821.70 | Apr-2022  | oregon     |
-- | 20220325-01-01 | 2022-04-01 | 2022-04-30 | $40,126.70 | Apr-2022  | Louisiana  |
-- | 20220329-01-11 | 2022-04-01 | 2022-04-30 | $9,566.40  | Apr-2022  | Idaho      |
-- | 20220325-01-02 | 2022-04-01 | 2022-04-30 | $19,928.40 | Apr-2022  | Florida    |
-- | 20220325-01-03 | 2022-04-01 | 2022-04-30 | $15,656.20 | Apr-2022  | Tennessee  |
-- | 20220329-01-12 | 2022-04-01 | 2022-04-30 | $12,628.60 | Apr-2022  | Montana    |
-- | 20220330-02-19 | 2022-04-01 | 2022-04-30 | $26,575.40 | Apr-2022  | California |
-- | 20220330-02-20 | 2022-04-01 | 2022-04-30 | $37,781.50 | Apr-2022  | Utah       |
-- | 20220330-02-21 | 2022-04-01 | 2022-04-30 | $36,718.60 | Apr-2022  | Arizona    |
-- | 20220329-01-13 | 2022-08-01 | 2022-08-30 | $20,321.20 | Aug-2022  | oregon     |
-- | 20220329-01-14 | 2022-08-01 | 2022-08-30 | $21,920.90 | Aug-2022  | Idaho      |
-- | 20220325-01-04 | 2022-08-01 | 2022-08-30 | $28,149.00 | Aug-2022  | Louisiana  |
-- | 20220330-02-23 | 2022-08-01 | 2022-08-30 | $29,166.50 | Aug-2022  | Utah       |
-- | 20220330-02-24 | 2022-08-01 | 2022-08-30 | $20,141.00 | Aug-2022  | Arizona    |
-- | 20220325-01-05 | 2022-08-01 | 2022-08-30 | $28,326.40 | Aug-2022  | Florida    |
-- | 20220330-02-22 | 2022-08-01 | 2022-08-30 | $29,384.40 | Aug-2022  | California |
-- | 20220329-01-15 | 2022-08-01 | 2022-08-30 | $23,888.50 | Aug-2022  | Montana    |
-- | 20220325-01-06 | 2022-08-01 | 2022-08-30 | $17,441.40 | Aug-2022  | Tennessee  |
-- | 20220329-01-16 | 2022-12-01 | 2022-12-30 | $37,152.20 | Dec-2022  | oregon     |
-- | 20220329-01-17 | 2022-12-01 | 2022-12-30 | $25,655.00 | Dec-2022  | Idaho      |
-- | 20220325-01-07 | 2022-12-01 | 2022-12-30 | $42,953.60 | Dec-2022  | Louisiana  |
-- | 20220330-02-26 | 2022-12-01 | 2022-12-30 | $37,046.40 | Dec-2022  | Utah       |
-- | 20220330-02-25 | 2022-12-01 | 2022-12-30 | $25,291.00 | Dec-2022  | California |
-- | 20220325-01-08 | 2022-12-01 | 2022-12-30 | $41,513.90 | Dec-2022  | Florida    |
-- | 20220329-01-18 | 2022-12-01 | 2022-12-30 | $38,664.20 | Dec-2022  | Montana    |
-- | 20220330-02-27 | 2022-12-01 | 2022-12-30 | $10,496.50 | Dec-2022  | Arizona    |
-- | 20220325-01-09 | 2022-12-01 | 2022-12-30 | $22,601.00 | Dec-2022  | Tennessee  |
-- +----------------+------------+------------+------------+-----------+------------+
-- 36 rows in set (0.01 sec)

    
        
    </pre>
</main>   
</body>
</html>